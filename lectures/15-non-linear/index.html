<!DOCTYPE html><html lang="en-us" >

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  
  
  <meta name="generator" content="Wowchemy 5.0.0-beta.1 for Hugo">
  

  

  
  

  
  
  
  
  
    
    
    
  
  

  

  
  
  
    
  
  <meta name="description" content="Polynomial Regression Polynomial regression adds additional flexibility to the linear regression model to model non-linear trends. It should be noted specifically here that the data modeled here are not longitudinal data.">

  
  <link rel="alternate" hreflang="en-us" href="https://psqf6243.brandonlebeau.org/lectures/15-non-linear/">

  







  




  
  
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  

  
  
  
  <meta name="theme-color" content="#1565c0">
  

  
  
  
  <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha256-FMvZuGapsJLjouA6k7Eo2lusoAX9i0ShlWFG6qt7SLc=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous" media="print" onload="this.media='all'">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github.min.css" crossorigin="anonymous" title="hl-light" media="print" onload="this.media='all'">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" media="print" onload="this.media='all'" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.css" integrity="sha512-1xoFisiGdy9nvho8EgXuXvnpR5GAMSjFwp40gSRE3NwdUdIMIKuPa7bqoUhLD0O/5tPNhteAsE5XyyMi5reQVA==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.2.2/lazysizes.min.js" integrity="sha512-TmDwFLhg3UA4ZG0Eb4MIyT1O1Mb+Oww5kFG0uHqXsdbyZz9DcvYQhKpGgNkamAI6h2lGGZq2X8ftOJvF/XjTUg==" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    

  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.3aad675291f323c3cd47ae187f0bf0d6.css">

  




  

  


  
  

  

  
  <link rel="manifest" href="/index.webmanifest">
  

  <link rel="icon" type="image/png" href="/images/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_32x32_fill_lanczos_center_3.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_192x192_fill_lanczos_center_3.png">

  <link rel="canonical" href="https://psqf6243.brandonlebeau.org/lectures/15-non-linear/">

  
  
  
  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="og:site_name" content="PSQF 6243">
  <meta property="og:url" content="https://psqf6243.brandonlebeau.org/lectures/15-non-linear/">
  <meta property="og:title" content="Non-Linear Trends | PSQF 6243">
  <meta property="og:description" content="Polynomial Regression Polynomial regression adds additional flexibility to the linear regression model to model non-linear trends. It should be noted specifically here that the data modeled here are not longitudinal data."><meta property="og:image" content="https://psqf6243.brandonlebeau.org/media/blue-balloon.jpg">
  <meta property="twitter:image" content="https://psqf6243.brandonlebeau.org/media/blue-balloon.jpg"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2023-11-02T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2023-11-02T00:00:00&#43;00:00">
  

  



  


  


  





  <title>Non-Linear Trends | PSQF 6243</title>

</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper  ">

  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.7de282f2047be3c570af3a58788341e7.js"></script>

  

<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="Search...">
        
      </div>

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header">
    












<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">PSQF 6243</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">PSQF 6243</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#logistics"><span>Logistics</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/syllabus/"><span>Syllabus</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/schedule/"><span>Schedule</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/content/"><span>Content</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link  active" href="/lectures/"><span>Lecture Notes</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/assignments/"><span>Assignments</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/code/"><span>Software Resources</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#people"><span>People</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

      
      
        
      

      
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true" aria-label="Display preferences">
          <i class="fas fa-moon" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      

    </ul>

  </div>
</nav>


  </div>

  <div class="page-body">
    





<div class="container-fluid docs">
  <div class="row flex-xl-nowrap">
    <div class="col-12 col-md-3 col-xl-2 docs-sidebar">
      <form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-3" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <span><i class="fas fa-bars"></i></span>
  </button>

  
  <button class="form-control sidebar-search js-search">
    <i class="fas fa-search pr-2"></i>
    <span class="sidebar-search-text">Search...</span>
    <span class="sidebar-search-shortcut">/</span>
  </button>
  
</form>

<nav class="collapse docs-links" id="docs-nav">
  
  
  
  
  
  

  
  
    

    
      

      
      
      


  
    
    
    
    
      
    
    

    
      <ul class="nav docs-sidenav">
        <li class=""><a href="/lectures/">Lecture Notes</a></li>
    
      


  <li class=""><a href="/lectures/01-review/">Review</a></li>



  <li class=""><a href="/lectures/02-linear-regression/">Introduction to Linear Regression</a></li>



  <li class=""><a href="/lectures/02a-in-class-activity/">Linear Regression - In Class</a></li>



  <li class=""><a href="/lectures/03-regression-estimates/">Regression Estimation</a></li>



  <li class=""><a href="/lectures/04-least-squares-simulation/">Least Squares Minimization</a></li>



  <li class=""><a href="/lectures/05-regression-inference/">Inference for regression parameters</a></li>



  <li class=""><a href="/lectures/05a-regression-in-class/">Regression in class</a></li>



  <li class=""><a href="/lectures/06-regression-conditions/">Conditions for Linear Regression</a></li>



  <li class=""><a href="/lectures/07-bootstrap/">Bootstrap</a></li>



  <li class=""><a href="/lectures/08-multiple-regression-class/">Multiple Regression - In Class Notes</a></li>



  <li class=""><a href="/lectures/08-multiple-regression/">Multiple Regression</a></li>



  <li class=""><a href="/lectures/09-model-comparison/">Multiple Comparisons</a></li>



  <li class=""><a href="/lectures/10-regression-categorical/">Regression with Categorical Predictors</a></li>



  <li class=""><a href="/lectures/11-pairwise/">Pairwise Contrasts</a></li>



  <li class=""><a href="/lectures/12-multiple-categorical/">Multiple Categorical Predictors</a></li>



  <li class=""><a href="/lectures/13-ancova/">Analysis of Covariance</a></li>



  <li class=""><a href="/lectures/14-prepost/">Pre / Post Designs</a></li>



  <li class="active"><a href="/lectures/15-non-linear/">Non-Linear Trends</a></li>



  <li class=""><a href="/lectures/02-linear-regression-inclass/">Linear Regression - In Class</a></li>



  <li class=""><a href="/lectures/07-bootstrap-class/">An R Markdown document converted from &#34;content/lectures/07-bootstrap-class.ipynb&#34;</a></li>

      
    

    
      </ul>
    

  
</nav>

    </div>

    
    
    <div class="d-none d-xl-block col-xl-2 docs-toc">
      <ul class="nav toc-top">
        <li><a href="#" id="back_to_top" class="docs-toc-title">Contents</a></li>
      </ul>

      

      
    </div>
    

    <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role="main">

      <article class="article">

        <div class="docs-article-container">
          

          <h1>Non-Linear Trends</h1>

          <div class="article-style">
            

<div id="TOC">

</div>

<div id="polynomial-regression" class="section level2">
<h2>Polynomial Regression</h2>
<p>Polynomial regression adds additional flexibility to the linear regression model to model non-linear trends. It should be noted specifically here that the data modeled here are not longitudinal data. These are data that are collected at a single time point, but the form of relationship is non-linear.</p>
<p>There are non-linear regression models that can be specified directly. Those are more challenging, difficult to interpret, and difficult to estimate. I also do not personally use those types of methods, therefore, the focus in this section of notes is to show that non-linear trends can be modeled using linear regression and maintain the additivity of the model.</p>
<p>The key to modeling non-linear trends using a linear regression model, is to add polynomial terms. For example, suppose we think that believe there is a non-linear trend. The simplest model would look like the following:</p>
<p><span class="math display">\[
Y = \beta_{0} + \beta_{1} X + \beta_{2} X^{2} + \epsilon
\]</span></p>
<p>In this model, the single <span class="math inline">\(X\)</span> attribute/predictor is included. The model includes the linear association, but also includes a quadratic association which would estimate/allow the regression line to be curvilinear rather than straight. Further polynomial terms (i.e., cubic, quartic, etc.) could be added. These terms are challenging to interpret, therefore, often visualizing the relationship helps to identify the effect of the non-linearity.</p>
<p><span class="math display">\[
Y = \beta_{0}^{\beta_{1} X} + \epsilon
\]</span></p>
<div id="example" class="section level3">
<h3>Example</h3>
<p>We will again use simulated data to show the model, but will base this on a real research paper:</p>
<p>Glomb, T. M., &amp; Welsh, E. T. (2005). Can opposites attract? Personality heterogeneity in supervisor-subordinate dyads as a predictor of subordinate outcomes. Journal of Applied Psychology, 90(4), 749.</p>
<p>This study looked to explore “Hypothesis 1: Differences between the supervisor and the subordinate in control traits (with the supervisor being higher) will be related to higher subordinate satisfaction with the supervisor.”</p>
<p><span class="math display">\[
satisfaction = \beta_{0} + \beta_{1} sup\_control + \beta_{2} sub\_control + \beta_{3} sup\_control^2 + \beta_{4} sub\_control^2 + \epsilon
\]</span></p>
<pre class="r"><code>library(tidyverse)</code></pre>
<pre><code>## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
## ✔ dplyr     1.1.2     ✔ readr     2.1.4
## ✔ forcats   1.0.0     ✔ stringr   1.5.0
## ✔ ggplot2   3.4.4     ✔ tibble    3.2.1
## ✔ lubridate 1.9.2     ✔ tidyr     1.3.0
## ✔ purrr     1.0.2     
## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()
## ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
<pre class="r"><code>library(ggformula)</code></pre>
<pre><code>## Loading required package: ggstance
## 
## Attaching package: &#39;ggstance&#39;
## 
## The following objects are masked from &#39;package:ggplot2&#39;:
## 
##     geom_errorbarh, GeomErrorbarh
## 
## Loading required package: scales
## 
## Attaching package: &#39;scales&#39;
## 
## The following object is masked from &#39;package:purrr&#39;:
## 
##     discard
## 
## The following object is masked from &#39;package:readr&#39;:
## 
##     col_factor
## 
## Loading required package: ggridges
## 
## New to ggformula?  Try the tutorials: 
## 	learnr::run_tutorial(&quot;introduction&quot;, package = &quot;ggformula&quot;)
## 	learnr::run_tutorial(&quot;refining&quot;, package = &quot;ggformula&quot;)</code></pre>
<pre class="r"><code>library(mosaic)</code></pre>
<pre><code>## Registered S3 method overwritten by &#39;mosaic&#39;:
##   method                           from   
##   fortify.SpatialPolygonsDataFrame ggplot2
## 
## The &#39;mosaic&#39; package masks several functions from core packages in order to add 
## additional features.  The original behavior of these functions should not be affected by this.
## 
## Attaching package: &#39;mosaic&#39;
## 
## The following object is masked from &#39;package:Matrix&#39;:
## 
##     mean
## 
## The following object is masked from &#39;package:scales&#39;:
## 
##     rescale
## 
## The following objects are masked from &#39;package:dplyr&#39;:
## 
##     count, do, tally
## 
## The following object is masked from &#39;package:purrr&#39;:
## 
##     cross
## 
## The following object is masked from &#39;package:ggplot2&#39;:
## 
##     stat
## 
## The following objects are masked from &#39;package:stats&#39;:
## 
##     binom.test, cor, cor.test, cov, fivenum, IQR, median, prop.test,
##     quantile, sd, t.test, var
## 
## The following objects are masked from &#39;package:base&#39;:
## 
##     max, mean, min, prod, range, sample, sum</code></pre>
<pre class="r"><code>library(simglm)

theme_set(theme_bw(base_size = 16))

sim_args &lt;- list(
    formula = satisfaction ~ 1 + poly(sup_control, degree = 2, raw = TRUE) + poly(sub_control, degree = 2, raw = TRUE),
    fixed = list(
        sup_control = list(var_type = &#39;continuous&#39;, 
        mean = 0, sd = 10.93),
        sub_control = list(var_type = &#39;continuous&#39;, 
        mean = 0, sd = 9.81)
    ),
    error = list(variance = 50),
    sample_size = 200,
    reg_weights = c(0, .109, -0.03, -.109, 0)
)

satis_data &lt;- simulate_fixed(data = NULL, sim_args) |&gt; 
  simulate_error(sim_args) |&gt;
  generate_response(sim_args)

head(satis_data)</code></pre>
<pre><code>##   X.Intercept. sup_control_1 sup_control_2 sub_control_1 sub_control_2
## 1            1      4.203259      17.66738    -13.984398     195.56339
## 2            1     15.428933     238.05196     -4.602340      21.18153
## 3            1     19.716769     388.75098    -26.821904     719.41452
## 4            1     11.908868     141.82115     -5.530018      30.58110
## 5            1     10.749993     115.56235    -13.294717     176.74949
## 6            1      4.476296      20.03722     -6.421037      41.22971
##   sup_control sub_control level1_id      error fixed_outcome random_effects
## 1    4.203259  -13.984398         1   1.590351     1.4524331              0
## 2   15.428933   -4.602340         2  -8.319683    -4.9581502              0
## 3   19.716769  -26.821904         3 -11.923641    -6.5898140              0
## 4   11.908868   -5.530018         4  -2.995082    -2.3537958              0
## 5   10.749993  -13.294717         5   4.432907    -0.8459971              0
## 6    4.476296   -6.421037         6  -1.302958     0.5866925              0
##   satisfaction
## 1    3.0427842
## 2  -13.2778332
## 3  -18.5134550
## 4   -5.3488780
## 5    3.5869104
## 6   -0.7162654</code></pre>
<pre class="r"><code>gf_point(satisfaction ~ sup_control, data = satis_data, size = 4) |&gt;
  gf_smooth(method = &#39;lm&#39;, linewidth = 2) |&gt;
  gf_smooth(method = &#39;loess&#39;, linewidth = 2)</code></pre>
<p><img src="/lectures/15-non-linear_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<pre class="r"><code>gf_point(satisfaction ~ sub_control, data = satis_data, size = 4) |&gt;
  gf_smooth(method = &#39;lm&#39;, linewidth = 2) |&gt;
  gf_smooth(method = &#39;loess&#39;, linewidth = 2)</code></pre>
<p><img src="/lectures/15-non-linear_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<pre class="r"><code>lm(satisfaction ~ 1 + sup_control + sub_control, data = satis_data) |&gt; 
   broom::tidy() |&gt; 
   mutate_if(is.double, round, 3)</code></pre>
<pre><code>## # A tibble: 3 × 5
##   term        estimate std.error statistic p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
## 1 (Intercept)   -4.07      0.658     -6.18   0    
## 2 sup_control    0.129     0.056      2.31   0.022
## 3 sub_control   -0.089     0.07      -1.27   0.204</code></pre>
<pre class="r"><code>lm(satisfaction ~ 1 + sup_control + sub_control + 
    I(sup_control^2) + I(sub_control^2) + 
    I(sup_control^3), data = satis_data) |&gt; 
   broom::tidy() |&gt; 
   mutate_if(is.double, round, 3)</code></pre>
<pre><code>## # A tibble: 6 × 5
##   term             estimate std.error statistic p.value
##   &lt;chr&gt;               &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
## 1 (Intercept)         0.341     0.66      0.516   0.606
## 2 sup_control         0.24      0.069     3.47    0.001
## 3 sub_control        -0.067     0.051    -1.32    0.188
## 4 I(sup_control^2)   -0.031     0.002   -13.0     0    
## 5 I(sub_control^2)   -0.001     0.004    -0.341   0.733
## 6 I(sup_control^3)    0         0        -0.755   0.451</code></pre>
<pre class="r"><code>tmp &lt;- lm(satisfaction ~ 1 + sup_control + sub_control + I(sup_control^2) + I(sub_control^2), data = satis_data) |&gt; 
  broom::augment()

head(tmp)</code></pre>
<pre><code>## # A tibble: 6 × 11
##   satisfaction[,1] sup_control sub_control `I(sup_control^2)` `I(sub_control^2)`
##              &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;           &lt;I&lt;dbl&gt;&gt;           &lt;I&lt;dbl&gt;&gt;
## 1            3.04         4.20      -14.0                17.7              196. 
## 2          -13.3         15.4        -4.60              238.                21.2
## 3          -18.5         19.7       -26.8               389.               719. 
## 4           -5.35        11.9        -5.53              142.                30.6
## 5            3.59        10.7       -13.3               116.               177. 
## 6           -0.716        4.48       -6.42               20.0               41.2
## # ℹ 6 more variables: .fitted &lt;dbl&gt;, .resid &lt;dbl&gt;, .hat &lt;dbl&gt;, .sigma &lt;dbl&gt;,
## #   .cooksd &lt;dbl&gt;, .std.resid &lt;dbl&gt;</code></pre>
<pre class="r"><code>gf_point(.fitted ~ sub_control, data = tmp, size = 2) |&gt; 
  gf_smooth() </code></pre>
<pre><code>## `geom_smooth()` using method = &#39;loess&#39;</code></pre>
<p><img src="/lectures/15-non-linear_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
</div>
<div id="spline-models" class="section level2">
<h2>Spline Models</h2>
<p>There are also a type of model called spline models that can also help with the flexibility of the linear regression model. The simplest type of spline model are called linear-linear spline models. These types of models are purely linear, but the linear slope does not need to be the same across the entire span. These can be of interest when something occurs at a specific value of an attribute.</p>
<p>For example (this example is completely hypothetical), imagine a situation where you are predicting anxiety symptomolgy by the age of the individual. Suppose we are interested in knowing if there are differential associations across different age spans, spline models can aid in this type of estimation.</p>
<pre class="r"><code>sim_args &lt;- list(
    formula = anxiety ~ 1 + age + age_group_post + age:age_group_post,
    fixed = list(
        age = list(var_type = &#39;ordinal&#39;, 
        levels = 20:80)
    ),
    post = list(age_group_post = list(variable = &#39;age&#39;, 
                               fun = &#39;ifelse&#39;,
                               condition = &#39;&gt;= 50&#39;,
                               yes = 1,
                               no = 0)),
    error = list(variance = 50),
    sample_size = 1000,
    reg_weights = c(5, 0.05, -1, -0.1)
)

anxiety_data &lt;- simulate_fixed(data = NULL, sim_args) |&gt; 
  simulate_error(sim_args) |&gt;
  generate_response(sim_args)

head(anxiety_data)</code></pre>
<pre><code>##   X.Intercept. age age_group_post age.age_group_post level1_id     error
## 1            1  79              1                 79         1  3.512515
## 2            1  64              1                 64         2 -2.417183
## 3            1  23              0                  0         3  1.499785
## 4            1  80              1                 80         4 12.217905
## 5            1  32              0                  0         5  5.326531
## 6            1  40              0                  0         6 -3.572127
##   fixed_outcome random_effects   anxiety
## 1  5.000000e-02              0  3.562515
## 2  8.000000e-01              0 -1.617183
## 3  6.150000e+00              0  7.649785
## 4 -4.440892e-16              0 12.217905
## 5  6.600000e+00              0 11.926531
## 6  7.000000e+00              0  3.427873</code></pre>
<pre class="r"><code>gf_point(anxiety ~ age, data = anxiety_data, size = 2, alpha = 0.5) |&gt; 
  gf_smooth(method = &#39;lm&#39;, linewidth = 2)</code></pre>
<p><img src="/lectures/15-non-linear_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<pre class="r"><code>gf_point(anxiety ~ age, data = anxiety_data, color = ~factor(age_group_post), size = 2, alpha = 0.5) |&gt; 
  gf_smooth(method = &#39;lm&#39;, linewidth = 2) |&gt; 
  gf_labs(color = &quot;Age Group&quot;)</code></pre>
<p><img src="/lectures/15-non-linear_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<pre class="r"><code>lm(anxiety ~ 1 + age + age_group_post, data = anxiety_data) |&gt; 
  broom::tidy() |&gt; 
  mutate_if(is.double, round, 3)</code></pre>
<pre><code>## # A tibble: 3 × 5
##   term           estimate std.error statistic p.value
##   &lt;chr&gt;             &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
## 1 (Intercept)       8.24      0.937      8.79   0    
## 2 age              -0.043     0.025     -1.71   0.087
## 3 age_group_post   -4.42      0.859     -5.15   0</code></pre>
<pre class="r"><code>lm(anxiety ~ 1 + age + age_group_post + age:age_group_post, data = anxiety_data) |&gt; 
  broom::tidy() |&gt; 
  mutate_if(is.double, round, 3)</code></pre>
<pre><code>## # A tibble: 4 × 5
##   term               estimate std.error statistic p.value
##   &lt;chr&gt;                 &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
## 1 (Intercept)           5.69      1.37      4.16    0    
## 2 age                   0.029     0.038     0.78    0.436
## 3 age_group_post        1.72      2.56      0.673   0.501
## 4 age:age_group_post   -0.127     0.05     -2.55    0.011</code></pre>
<pre class="r"><code>sim_args &lt;- list(
    formula = anxiety ~ 1 + age + age_group_post + age:age_group_post,
    fixed = list(
        age = list(var_type = &#39;ordinal&#39;, 
        levels = -30:30)
    ),
    post = list(age_group_post = list(variable = &#39;age&#39;, 
                               fun = &#39;ifelse&#39;,
                               condition = &#39;&gt;= 0&#39;,
                               yes = 1,
                               no = 0)),
    error = list(variance = 10),
    sample_size = 1000,
    reg_weights = c(5, 0.05, 0, -0.15)
)

anxiety_data2 &lt;- simulate_fixed(data = NULL, sim_args) |&gt; 
  simulate_error(sim_args) |&gt;
  generate_response(sim_args)

head(anxiety_data2)</code></pre>
<pre><code>##   X.Intercept. age age_group_post age.age_group_post level1_id     error
## 1            1  -2              0                  0         1 -1.479273
## 2            1   0              1                  0         2 -3.423205
## 3            1  22              1                 22         3  1.253110
## 4            1  -9              0                  0         4  1.181085
## 5            1 -13              0                  0         5 -2.807391
## 6            1 -17              0                  0         6  4.106960
##   fixed_outcome random_effects  anxiety
## 1          4.90              0 3.420727
## 2          5.00              0 1.576795
## 3          2.80              0 4.053110
## 4          4.55              0 5.731085
## 5          4.35              0 1.542609
## 6          4.15              0 8.256960</code></pre>
<pre class="r"><code>gf_point(anxiety ~ age, data = anxiety_data2, size = 2, alpha = 0.5) |&gt; 
  gf_smooth(method = &#39;lm&#39;, linewidth = 2)</code></pre>
<p><img src="/lectures/15-non-linear_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<pre class="r"><code>gf_point(anxiety ~ age, data = anxiety_data2, color = ~factor(age_group_post), size = 2, alpha = 0.5) |&gt; 
  gf_smooth(method = &#39;lm&#39;, linewidth = 2) |&gt; 
  gf_labs(color = &quot;Age Group&quot;)</code></pre>
<p><img src="/lectures/15-non-linear_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<pre class="r"><code>lm(anxiety ~ 1 + age + age_group_post, data = anxiety_data2) |&gt; 
  broom::tidy() |&gt; 
  mutate_if(is.double, round, 3)</code></pre>
<pre><code>## # A tibble: 3 × 5
##   term           estimate std.error statistic p.value
##   &lt;chr&gt;             &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
## 1 (Intercept)       3.70      0.229    16.1     0    
## 2 age              -0.024     0.011    -2.11    0.035
## 3 age_group_post    0.234     0.404     0.578   0.563</code></pre>
<pre class="r"><code>lm(anxiety ~ 1 + age + age_group_post + age:age_group_post, data = anxiety_data2) |&gt; 
  broom::tidy()|&gt; 
  mutate_if(is.double, round, 3)</code></pre>
<pre><code>## # A tibble: 4 × 5
##   term               estimate std.error statistic p.value
##   &lt;chr&gt;                 &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
## 1 (Intercept)           4.63      0.291     15.9    0    
## 2 age                   0.035     0.016      2.14   0.032
## 3 age_group_post        0.14      0.4        0.35   0.726
## 4 age:age_group_post   -0.114     0.022     -5.06   0</code></pre>
<pre class="r"><code>lm(anxiety ~ 1 + age + I(age^2), data = anxiety_data2) |&gt; 
broom::tidy() |&gt; 
mutate_if(is.double, round, 3)</code></pre>
<pre><code>## # A tibble: 3 × 5
##   term        estimate std.error statistic p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
## 1 (Intercept)    4.36      0.149     29.3    0    
## 2 age           -0.019     0.006     -3.38   0.001
## 3 I(age^2)      -0.002     0         -4.82   0</code></pre>
<pre class="r"><code>gf_point(anxiety ~ age, data = anxiety_data2) |&gt; 
  gf_smooth(method = &#39;loess&#39;, linewidth = 2)</code></pre>
<p><img src="/lectures/15-non-linear_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
</div>

          </div>

          



          
          
          <div class="article-widget">
            
<div class="post-nav">
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Previous</div>
    <a href="/lectures/14-prepost/" rel="next">Pre / Post Designs</a>
  </div>
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Next</div>
    <a href="/lectures/02-linear-regression-inclass/" rel="prev">Linear Regression - In Class</a>
  </div>
  
</div>

          </div>
          
        </div>

        <div class="body-footer">
          <p>Last updated on Nov 2, 2023</p>

          



          




          


        </div>

      </article>

      <footer class="site-footer">
  

  <p class="powered-by">
    
  </p>

  
  






  <p class="powered-by">
    
    
    
    Published with
    <a href="https://wowchemy.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Wowchemy</a>  —
    the free, <a href="https://github.com/wowchemy/wowchemy-hugo-modules" target="_blank" rel="noopener">
    open source</a> website builder that empowers creators.
    
  </p>
</footer>


    </main>
  </div>
</div>

  </div>

  <div class="page-footer">
    
    
  </div>

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

      
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      

      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/instant.page/5.1.0/instantpage.min.js" integrity="sha512-1+qUtKoh9XZW7j+6LhRMAyOrgSQKenQ4mluTR+cvxXjP1Z54RxZuzstR/H9kgPXQsVB8IW7DMDFUJpzLjvhGSQ==" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js" integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/r.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.js" integrity="sha512-SeiQaaDh73yrb56sTW/RgVdi/mMqNeM2oBwubFHagc5BkixSpP1fvqF47mKzPGWYSSy4RwbBunrJBQ4Co8fRWA==" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'event' : "Events",
        'slides' : "Slides"
        };
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.2/anchor.min.js" integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin="anonymous"></script>
    <script>
      anchors.add();
    </script>
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    
    

    
    

    
    

    
    
    
    
    
    
    
    
    
    
      
      
    
    
    <script src="/js/wowchemy.min.d4185df71ecf716f1c4e7ef5f3d4e2b8.js"></script>

    






</body>
</html>
