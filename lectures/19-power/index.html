<!DOCTYPE html><html lang="en-us" >

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  
  
  <meta name="generator" content="Wowchemy 5.0.0-beta.1 for Hugo">
  

  

  
  

  
  
  
  
  
    
    
    
  
  

  

  
  
  
    
  
  <meta name="description" content="Power">

  
  <link rel="alternate" hreflang="en-us" href="https://psqf6243.brandonlebeau.org/lectures/19-power/">

  







  




  
  
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  

  
  
  
  <meta name="theme-color" content="#1565c0">
  

  
  
  
  <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha256-FMvZuGapsJLjouA6k7Eo2lusoAX9i0ShlWFG6qt7SLc=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous" media="print" onload="this.media='all'">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github.min.css" crossorigin="anonymous" title="hl-light" media="print" onload="this.media='all'">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" media="print" onload="this.media='all'" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.css" integrity="sha512-1xoFisiGdy9nvho8EgXuXvnpR5GAMSjFwp40gSRE3NwdUdIMIKuPa7bqoUhLD0O/5tPNhteAsE5XyyMi5reQVA==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.2.2/lazysizes.min.js" integrity="sha512-TmDwFLhg3UA4ZG0Eb4MIyT1O1Mb+Oww5kFG0uHqXsdbyZz9DcvYQhKpGgNkamAI6h2lGGZq2X8ftOJvF/XjTUg==" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    

  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.3aad675291f323c3cd47ae187f0bf0d6.css">

  




  

  


  
  

  

  
  <link rel="manifest" href="/index.webmanifest">
  

  <link rel="icon" type="image/png" href="/images/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_32x32_fill_lanczos_center_3.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_192x192_fill_lanczos_center_3.png">

  <link rel="canonical" href="https://psqf6243.brandonlebeau.org/lectures/19-power/">

  
  
  
  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="og:site_name" content="PSQF 6243">
  <meta property="og:url" content="https://psqf6243.brandonlebeau.org/lectures/19-power/">
  <meta property="og:title" content="Power | PSQF 6243">
  <meta property="og:description" content="Power"><meta property="og:image" content="https://psqf6243.brandonlebeau.org/media/blue-balloon.jpg">
  <meta property="twitter:image" content="https://psqf6243.brandonlebeau.org/media/blue-balloon.jpg"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2021-12-08T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2021-12-08T00:00:00&#43;00:00">
  

  



  


  


  





  <title>Power | PSQF 6243</title>

</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper  ">

  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.7de282f2047be3c570af3a58788341e7.js"></script>

  

<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="Search...">
        
      </div>

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header">
    












<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">PSQF 6243</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">PSQF 6243</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#logistics"><span>Logistics</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/syllabus/"><span>Syllabus</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/schedule/"><span>Schedule</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/content/"><span>Content</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link  active" href="/lectures/"><span>Lecture Notes</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/assignments/"><span>Assignments</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/code/"><span>Software Resources</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#people"><span>People</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

      
      
        
      

      
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true" aria-label="Display preferences">
          <i class="fas fa-moon" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      

    </ul>

  </div>
</nav>


  </div>

  <div class="page-body">
    





<div class="container-fluid docs">
  <div class="row flex-xl-nowrap">
    <div class="col-12 col-md-3 col-xl-2 docs-sidebar">
      <form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-3" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <span><i class="fas fa-bars"></i></span>
  </button>

  
  <button class="form-control sidebar-search js-search">
    <i class="fas fa-search pr-2"></i>
    <span class="sidebar-search-text">Search...</span>
    <span class="sidebar-search-shortcut">/</span>
  </button>
  
</form>

<nav class="collapse docs-links" id="docs-nav">
  
  
  
  
  
  

  
  
    

    
      

      
      
      


  
    
    
    
    
      
    
    

    
      <ul class="nav docs-sidenav">
        <li class=""><a href="/lectures/">Lecture Notes</a></li>
    
      


  <li class=""><a href="/lectures/review/">Review</a></li>



  <li class=""><a href="/lectures/review-class/">Review - class</a></li>



  <li class=""><a href="/lectures/intro-regression/">Intro to Linear Regression</a></li>



  <li class=""><a href="/lectures/linear-regression-class/">Intro to Linear Regression - class</a></li>



  <li class=""><a href="/lectures/regression-estimates/">Linear Regression Estimates</a></li>



  <li class=""><a href="/lectures/regression-estimates-class/">Linear Regression Estimates - class</a></li>



  <li class=""><a href="/lectures/least-squares-simulation/">Least Square Simulation</a></li>



  <li class=""><a href="/lectures/regression-inference-p1/">Regression Inference - Part 1</a></li>



  <li class=""><a href="/lectures/05-regression-inference/">Regression Inference - Part 1</a></li>



  <li class=""><a href="/lectures/05a-regression-inference/">Regression Inference - Part 2</a></li>



  <li class=""><a href="/lectures/05a-regression-inference-class/">Regression Inference - Part 2 - Class</a></li>



  <li class=""><a href="/lectures/06-t-vs-norm/">t vs Normal</a></li>



  <li class=""><a href="/lectures/07-regression-assumptions/">Regression Assumptions</a></li>



  <li class=""><a href="/lectures/07a-regression-assumptions/">Regression Assumptions - New Package</a></li>



  <li class=""><a href="/lectures/08-bootstrap/">Regression Bootstrap</a></li>



  <li class=""><a href="/lectures/08-bootstrap-class/">Regression Bootstrap - Class</a></li>



  <li class=""><a href="/lectures/09-multiple-regression-p1/">Multiple Regression - Part 1</a></li>



  <li class=""><a href="/lectures/09-multiple-regression-p1-class/">Multiple Regression - Part 1</a></li>



  <li class=""><a href="/lectures/10-model-comparison/">Model Comparison</a></li>



  <li class=""><a href="/lectures/10-model-comparison-class/">Model Comparison</a></li>



  <li class=""><a href="/lectures/11-multicollinearity/">Multicollinearity</a></li>



  <li class=""><a href="/lectures/11-multicollinearity-class/">Multicollinearity</a></li>



  <li class=""><a href="/lectures/12-regression-categorical/">Regression Categorical Predictors</a></li>



  <li class=""><a href="/lectures/12-regression-categorical-class/">Regression Categorical Predictors</a></li>



  <li class=""><a href="/lectures/13-regression-categorical-p2/">Regression Categorical Predictors - p2</a></li>



  <li class=""><a href="/lectures/13-regression-categorical-p2-class/">Regression Categorical Predictors - p2</a></li>



  <li class=""><a href="/lectures/14-pairwise/">Pairwise Contrasts</a></li>



  <li class=""><a href="/lectures/14-pairwise-class/">Pairwise Contrasts</a></li>



  <li class=""><a href="/lectures/15-multiple-categorical/">Multiple Categorical Predictors</a></li>



  <li class=""><a href="/lectures/15-multiple-categorical-class/">Multiple Categorical Predictors - Class</a></li>



  <li class=""><a href="/lectures/16-ancova/">Analysis of Covariance</a></li>



  <li class=""><a href="/lectures/16-ancova-class/">Analysis of Covariance - Class</a></li>



  <li class=""><a href="/lectures/17-categorical-interactions/">Categorical Interactions</a></li>



  <li class=""><a href="/lectures/17-categorical-interactions-class/">Categorical Interactions - Class</a></li>



  <li class=""><a href="/lectures/18-chi-square/">Chi-Square</a></li>



  <li class=""><a href="/lectures/18-chi-square-class/">Chi-Square - Class</a></li>



  <li class="active"><a href="/lectures/19-power/">Power</a></li>

      
    

    
      </ul>
    

  
</nav>

    </div>

    
    
    <div class="d-none d-xl-block col-xl-2 docs-toc">
      <ul class="nav toc-top">
        <li><a href="#" id="back_to_top" class="docs-toc-title">Contents</a></li>
      </ul>

      

      
    </div>
    

    <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role="main">

      <article class="article">

        <div class="docs-article-container">
          

          <h1>Power</h1>

          <div class="article-style">
            
<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>

<div id="TOC">

</div>

<div id="power-analysis" class="section level1">
<h1>Power Analysis</h1>
<p>A power analysis is similar to that of exploratory data analysis, the power analysis should be done thoroughly and explored through many different elements. For example, power should be evaluated across a variety of realistic data conditions.</p>
<div id="what-is-power" class="section level2">
<h2>What is Power?</h2>
<p>Power is the ability to detect an effect of interest. Put into statistical terms, this could be phrased as detecting a non-zero effect or rejecting the statistical null hypothesis (or more accurately providing evidence that the statistical null hypothesis is unlikely to be true with the sample data).</p>
<p>Power is typically used for study planning and is often required by grant funding agencies. As suggested in the title, this book advocates for estimating power by simulation, but this is not the only framework for estimating power. Depending on the method, there may be closed form solutions that provide an alternative to estimating power by simulation. As discussed in Chapter 1, the primary benefits of power by simulation include:</p>
<p>When defining power, it is important to first define the statistical hypotheses that are framing the question(s) of interest. Although these will likely vary depending on the data collection method and statistical model fitted, the null and alternative hypotheses will typically follow this general framework when the analysis can be framed as a linear regression:</p>
<p><span class="math display">\[
H_{0}: \beta_{t} = 0
\]</span></p>
<p><span class="math display">\[ 
H_{A}: \beta_{t} \neq 0
\]</span></p>
<p>where <span class="math inline">\(H_{0}\)</span> is the null hypothesis representing that the regression parameter (<span class="math inline">\(\beta_{t}\)</span>) is equal to 0 in the population. The null hypothesis is the statistical hypothesis that the p-value is interpreted with respect to in frequentist statistics. When evaluating power, the second hypothesis, <span class="math inline">\(H_{A}\)</span> or the alternative hypothesis, is of more importance. This hypothesis represents the effect of interest or the distribution of the effect. More generally, this hypothesis is the hypothesis that would be true when the parameter of interest is not zero in the population, a common (but not always true) assumption when evaluating power.</p>
<p>If you have taken a statistics course before, you may have been shown the two by two table. This table shows the possible decisions that can be made when using the hypothesis testing framework above.</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right"><span class="math inline">\(H_{0}\)</span> true</th>
<th align="right"><span class="math inline">\(H_{0}\)</span> FALSE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Reject <span class="math inline">\(H_{0}\)</span></td>
<td align="right">Type I Error</td>
<td align="right">Correct (power)</td>
</tr>
<tr class="even">
<td align="left">Retain <span class="math inline">\(H_{0}\)</span></td>
<td align="right">Correct</td>
<td align="right">Type II Error</td>
</tr>
</tbody>
</table>
<p>Let’s assume the following model, this is essentially a two-sample t-test model where I am assuming that <span class="math inline">\(group_{i}\)</span> below represents two values.</p>
<p><span class="math display">\[
Y_{i} = \beta_{0} + \beta_{1} group_{i} + \epsilon_{i} 
\]</span></p>
<p>Power can be evaluated in a few different ways, one is through closed form equations that estimation power. A second way is to use power by simulation, which can be more accurate as estimating power through the closed form equations makes assumptions about the model.</p>
<p>One of the assumptions needed to be made is the size of the effect that will be estimated, these are typically done through the effect size metric. In the two-sample design, in many instances this represents the standardized mean difference.</p>
<pre class="r"><code>library(tidyverse)</code></pre>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──</code></pre>
<pre><code>## ✓ ggplot2 3.3.5     ✓ purrr   0.3.4
## ✓ tibble  3.1.6     ✓ dplyr   1.0.7
## ✓ tidyr   1.1.4     ✓ stringr 1.4.0
## ✓ readr   2.1.0     ✓ forcats 0.5.1</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>n &lt;- seq(4, 1000, 2)
power &lt;- sapply(seq_along(n), function(i) 
  power.t.test(n = n[i], delta = .15, sd = 1, type = &#39;two.sample&#39;)$power)

power_df &lt;- data.frame(
  n = n,
  power = power
)

ggplot(power_df, aes(x = n, y = power)) + 
  geom_line(size = 2) + 
  geom_hline(yintercept = 0.8, linetype = 2, color = &#39;gray30&#39;) + 
  geom_vline(xintercept = 700, linetype = 2, color = &#39;gray30&#39;) +
  scale_x_continuous(&quot;Sample Size&quot;, breaks = seq(0, 1000, 200)) + 
  scale_y_continuous(&quot;Power&quot;, breaks = seq(0, 1, .2)) +
  theme_bw(base_size = 14)</code></pre>
<p><img src="/lectures/19-power_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
</div>
<div id="power-curves" class="section level2">
<h2>Power Curves</h2>
<p>Power curves can be useful to show how power may change based on different values. Above, a power curve was plotted across sample sizes, but the following code estimates power for different effect size values.</p>
<pre class="r"><code>effect_sizes &lt;- c(.10, .15, .25)
conditions &lt;- expand.grid(n = n, effect_sizes = effect_sizes)

power_curve &lt;- sapply(seq_len(nrow(conditions)), function(i) 
  power.t.test(n = conditions[i, &#39;n&#39;], 
               delta = conditions[i, &#39;effect_sizes&#39;], 
               sd = 1, type = &#39;two.sample&#39;)$power)

power_curve_df &lt;- bind_cols(
  conditions, 
  power = power_curve
)

ggplot(power_curve_df, aes(x = n, y = power)) + 
  geom_line(aes(color = factor(effect_sizes)), size = 2) + 
  geom_hline(yintercept = 0.8, linetype = 2, color = &#39;gray30&#39;) + 
  scale_x_continuous(&quot;Sample Size&quot;, breaks = seq(0, 1000, 200)) + 
  scale_y_continuous(&quot;Power&quot;, breaks = seq(0, 1, .2)) +
  scale_color_discrete(&quot;Effect Size&quot;) +
  theme_bw(base_size = 14)</code></pre>
<p><img src="/lectures/19-power_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
</div>
<div id="power-by-simulation" class="section level2">
<h2>Power by simulation</h2>
<p>Power by simulation is similar, but it does not need to make as many assumptions about the data to be collected. As long as you are able to simulate the data, different conditions can be evaluated. This is particularly true for more complicated data situations.</p>
<pre class="r"><code>library(simglm)
library(future)

plan(multicore)</code></pre>
<pre><code>## Warning in supportsMulticoreAndRStudio(...): [ONE-TIME WARNING] Forked
## processing (&#39;multicore&#39;) is not supported when running R from RStudio
## because it is considered unstable. For more details, how to control forked
## processing or not, and how to silence this warning in future R sessions, see ?
## parallelly::supportsMulticore</code></pre>
<pre class="r"><code>simulation_arguments &lt;- list(
  formula = y ~ 1 + group, 
  fixed = list(group = list(var_type = &#39;factor&#39;, 
                            levels = c(&#39;red&#39;, &#39;blue&#39;))),
  error = list(variance = 1),
  reg_weights = c(0, .15),
  replications = 5000,
  model_fit = list(formula = y ~ 1 + group,
                   model_function = &#39;lm&#39;),
  power = list(
    dist = &#39;qt&#39;,
    alpha = .05
  ),
  extract_coefficients = TRUE,
  vary_arguments = list(
    sample_size = seq(20, 2000, 90) 
  )
)

model_results &lt;- replicate_simulation(simulation_arguments) 

power_results &lt;- model_results %&gt;%
  compute_statistics(simulation_arguments, power = TRUE,
                     type_1_error = FALSE, precision = TRUE)

power_results &lt;- power_results %&gt;%
  ungroup() %&gt;%
  mutate(sample_size = as.numeric(as.character(sample_size))) %&gt;%
  arrange(sample_size) %&gt;%
  filter(term == &#39;group&#39;)

ggplot(power_results, aes(x = sample_size, y = power)) + 
  geom_point(size = 1.5, color = &#39;gray40&#39;) + 
  geom_hline(yintercept = 0.8, linetype = 2, color = &#39;gray30&#39;) + 
  geom_smooth(linetype = 1, size = 1, se = FALSE) +
  geom_vline(xintercept = min(filter(power_results, power &gt;= 0.8)$power), 
             linetype = 2, color = &#39;gray30&#39;) +
  scale_x_continuous(&quot;Sample Size&quot;, breaks = seq(0, 2000, 200)) + 
  scale_y_continuous(&quot;Power&quot;, breaks = seq(0, 1, .2)) +
  theme_bw(base_size = 14)</code></pre>
<pre><code>## Warning in min(filter(power_results, power &gt;= 0.8)$power): no non-missing
## arguments to min; returning Inf</code></pre>
<pre><code>## Warning: Position guide is perpendicular to the intended axis. Did you mean to
## specify a different guide `position`?</code></pre>
<p><img src="/lectures/19-power_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<pre class="r"><code>model_results_df &lt;- bind_rows(model_results) %&gt;%
  filter(term == &#39;group&#39;) %&gt;%
  mutate(sample_size = as.numeric(as.character(sample_size)))

ggplot(model_results_df, aes(x = sample_size, y = estimate)) + 
  geom_boxplot(aes(group = sample_size), outlier.alpha = 0.01) +
  scale_x_continuous(&quot;Sample Size&quot;, breaks = seq(0, 2000, 200)) +
  theme_bw(base_size = 14) +
  geom_hline(yintercept = .15, linetype = 2, size = 2, color = &#39;gray20&#39;) +
  coord_flip()</code></pre>
<p><img src="/lectures/19-power_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<div id="add-heterogeneity" class="section level3">
<h3>Add Heterogeneity</h3>
<pre class="r"><code>simulation_arguments &lt;- list(
  formula = y ~ 1 + group,
  fixed = list(group = list(var_type = &#39;factor&#39;, 
                            levels = c(&#39;red&#39;, &#39;blue&#39;))),
  error = list(variance = 1),
  heterogeneity = list(variable = &#39;group&#39;,
                       variance = c(1, 8)),
  reg_weights = c(0, .15),
  replications = 5000,
  model_fit = list(formula = y ~ 1 + group, 
                   model_function = &#39;lm&#39;),
  power = list(
    dist = &#39;qnorm&#39;,
    alpha = .05
  ),
  extract_coefficients = TRUE,
  vary_arguments = list(
    sample_size = seq(20, 2000, 90) 
  )
)

model_results_h &lt;- replicate_simulation(simulation_arguments)

power_results_h &lt;- model_results_h %&gt;%
  compute_statistics(simulation_arguments, power = TRUE,
                     type_1_error = FALSE, precision = TRUE) %&gt;%
  ungroup() %&gt;%
  mutate(sample_size = as.numeric(as.character(sample_size)),
         heterogeneity = TRUE) %&gt;%
  arrange(sample_size) %&gt;%
  filter(term == &#39;group&#39;)

power_results &lt;- power_results %&gt;%
  mutate(heterogeneity = FALSE)

power_results_combined &lt;- bind_rows(power_results, 
                                    power_results_h)

ggplot(power_results_combined, aes(x = sample_size, y = power, 
                          group = heterogeneity)) + 
  geom_point(aes(shape = heterogeneity), size = 1.5, color = &#39;gray40&#39;) + 
  geom_hline(yintercept = 0.8, linetype = 2, color = &#39;gray30&#39;) + 
  geom_smooth(aes(linetype = heterogeneity), size = 1, se = FALSE) +
  scale_x_continuous(&quot;Sample Size&quot;, breaks = seq(0, 2000, 200)) + 
  scale_y_continuous(&quot;Power&quot;, breaks = seq(0, 1, .2)) +
  theme_bw(base_size = 14)</code></pre>
<p><img src="/lectures/19-power_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>
</div>
</div>

          </div>

          



          
          
          <div class="article-widget">
            
<div class="post-nav">
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Previous</div>
    <a href="/lectures/18-chi-square-class/" rel="next">Chi-Square - Class</a>
  </div>
  
  
</div>

          </div>
          
        </div>

        <div class="body-footer">
          <p>Last updated on Dec 8, 2021</p>

          



          




          


        </div>

      </article>

      <footer class="site-footer">
  

  <p class="powered-by">
    
  </p>

  
  






  <p class="powered-by">
    
    
    
    Published with
    <a href="https://wowchemy.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Wowchemy</a>  —
    the free, <a href="https://github.com/wowchemy/wowchemy-hugo-modules" target="_blank" rel="noopener">
    open source</a> website builder that empowers creators.
    
  </p>
</footer>


    </main>
  </div>
</div>

  </div>

  <div class="page-footer">
    
    
  </div>

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

      
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      

      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/instant.page/5.1.0/instantpage.min.js" integrity="sha512-1+qUtKoh9XZW7j+6LhRMAyOrgSQKenQ4mluTR+cvxXjP1Z54RxZuzstR/H9kgPXQsVB8IW7DMDFUJpzLjvhGSQ==" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js" integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/r.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.js" integrity="sha512-SeiQaaDh73yrb56sTW/RgVdi/mMqNeM2oBwubFHagc5BkixSpP1fvqF47mKzPGWYSSy4RwbBunrJBQ4Co8fRWA==" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'event' : "Events",
        'slides' : "Slides"
        };
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.2/anchor.min.js" integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin="anonymous"></script>
    <script>
      anchors.add();
    </script>
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    
    

    
    

    
    

    
    
    
    
    
    
    
    
    
    
      
      
    
    
    <script src="/js/wowchemy.min.d4185df71ecf716f1c4e7ef5f3d4e2b8.js"></script>

    






</body>
</html>
