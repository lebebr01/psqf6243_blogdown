<!DOCTYPE html><html lang="en-us" >

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  
  
  <meta name="generator" content="Wowchemy 5.0.0-beta.1 for Hugo">
  

  

  
  

  
  
  
  
  
    
    
    
  
  

  

  
  
  
    
  
  <meta name="description" content="Pairwise Contrasts">

  
  <link rel="alternate" hreflang="en-us" href="https://psqf6243.brandonlebeau.org/lectures/14-pairwise-class/">

  







  




  
  
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  

  
  
  
  <meta name="theme-color" content="#1565c0">
  

  
  
  
  <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha256-FMvZuGapsJLjouA6k7Eo2lusoAX9i0ShlWFG6qt7SLc=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous" media="print" onload="this.media='all'">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github.min.css" crossorigin="anonymous" title="hl-light" media="print" onload="this.media='all'">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" media="print" onload="this.media='all'" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.css" integrity="sha512-1xoFisiGdy9nvho8EgXuXvnpR5GAMSjFwp40gSRE3NwdUdIMIKuPa7bqoUhLD0O/5tPNhteAsE5XyyMi5reQVA==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.2.2/lazysizes.min.js" integrity="sha512-TmDwFLhg3UA4ZG0Eb4MIyT1O1Mb+Oww5kFG0uHqXsdbyZz9DcvYQhKpGgNkamAI6h2lGGZq2X8ftOJvF/XjTUg==" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    

  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.3aad675291f323c3cd47ae187f0bf0d6.css">

  




  

  


  
  

  

  
  <link rel="manifest" href="/index.webmanifest">
  

  <link rel="icon" type="image/png" href="/images/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_32x32_fill_lanczos_center_3.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_192x192_fill_lanczos_center_3.png">

  <link rel="canonical" href="https://psqf6243.brandonlebeau.org/lectures/14-pairwise-class/">

  
  
  
  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="og:site_name" content="PSQF 6243">
  <meta property="og:url" content="https://psqf6243.brandonlebeau.org/lectures/14-pairwise-class/">
  <meta property="og:title" content="Pairwise Contrasts | PSQF 6243">
  <meta property="og:description" content="Pairwise Contrasts"><meta property="og:image" content="https://psqf6243.brandonlebeau.org/media/blue-balloon.jpg">
  <meta property="twitter:image" content="https://psqf6243.brandonlebeau.org/media/blue-balloon.jpg"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2021-11-08T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2021-11-08T00:00:00&#43;00:00">
  

  



  


  


  





  <title>Pairwise Contrasts | PSQF 6243</title>

</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper  ">

  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.7de282f2047be3c570af3a58788341e7.js"></script>

  

<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="Search...">
        
      </div>

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header">
    












<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">PSQF 6243</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">PSQF 6243</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#logistics"><span>Logistics</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/syllabus/"><span>Syllabus</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/schedule/"><span>Schedule</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/content/"><span>Content</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link  active" href="/lectures/"><span>Lecture Notes</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/assignments/"><span>Assignments</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/code/"><span>Software Resources</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#people"><span>People</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

      
      
        
      

      
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true" aria-label="Display preferences">
          <i class="fas fa-moon" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      

    </ul>

  </div>
</nav>


  </div>

  <div class="page-body">
    





<div class="container-fluid docs">
  <div class="row flex-xl-nowrap">
    <div class="col-12 col-md-3 col-xl-2 docs-sidebar">
      <form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-3" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <span><i class="fas fa-bars"></i></span>
  </button>

  
  <button class="form-control sidebar-search js-search">
    <i class="fas fa-search pr-2"></i>
    <span class="sidebar-search-text">Search...</span>
    <span class="sidebar-search-shortcut">/</span>
  </button>
  
</form>

<nav class="collapse docs-links" id="docs-nav">
  
  
  
  
  
  

  
  
    

    
      

      
      
      


  
    
    
    
    
      
    
    

    
      <ul class="nav docs-sidenav">
        <li class=""><a href="/lectures/">Lecture Notes</a></li>
    
      


  <li class=""><a href="/lectures/review/">Review</a></li>



  <li class=""><a href="/lectures/review-class/">Review - class</a></li>



  <li class=""><a href="/lectures/intro-regression/">Intro to Linear Regression</a></li>



  <li class=""><a href="/lectures/linear-regression-class/">Intro to Linear Regression - class</a></li>



  <li class=""><a href="/lectures/regression-estimates/">Linear Regression Estimates</a></li>



  <li class=""><a href="/lectures/regression-estimates-class/">Linear Regression Estimates - class</a></li>



  <li class=""><a href="/lectures/least-squares-simulation/">Least Square Simulation</a></li>



  <li class=""><a href="/lectures/regression-inference-p1/">Regression Inference - Part 1</a></li>



  <li class=""><a href="/lectures/05-regression-inference/">Regression Inference - Part 1</a></li>



  <li class=""><a href="/lectures/05a-regression-inference/">Regression Inference - Part 2</a></li>



  <li class=""><a href="/lectures/05a-regression-inference-class/">Regression Inference - Part 2 - Class</a></li>



  <li class=""><a href="/lectures/06-t-vs-norm/">t vs Normal</a></li>



  <li class=""><a href="/lectures/07-regression-assumptions/">Regression Assumptions</a></li>



  <li class=""><a href="/lectures/07a-regression-assumptions/">Regression Assumptions - New Package</a></li>



  <li class=""><a href="/lectures/08-bootstrap/">Regression Bootstrap</a></li>



  <li class=""><a href="/lectures/08-bootstrap-class/">Regression Bootstrap - Class</a></li>



  <li class=""><a href="/lectures/09-multiple-regression-p1/">Multiple Regression - Part 1</a></li>



  <li class=""><a href="/lectures/09-multiple-regression-p1-class/">Multiple Regression - Part 1</a></li>



  <li class=""><a href="/lectures/10-model-comparison/">Model Comparison</a></li>



  <li class=""><a href="/lectures/10-model-comparison-class/">Model Comparison</a></li>



  <li class=""><a href="/lectures/11-multicollinearity/">Multicollinearity</a></li>



  <li class=""><a href="/lectures/11-multicollinearity-class/">Multicollinearity</a></li>



  <li class=""><a href="/lectures/12-regression-categorical/">Regression Categorical Predictors</a></li>



  <li class=""><a href="/lectures/12-regression-categorical-class/">Regression Categorical Predictors</a></li>



  <li class=""><a href="/lectures/13-regression-categorical-p2/">Regression Categorical Predictors - p2</a></li>



  <li class=""><a href="/lectures/13-regression-categorical-p2-class/">Regression Categorical Predictors - p2</a></li>



  <li class=""><a href="/lectures/14-pairwise/">Pairwise Contrasts</a></li>



  <li class="active"><a href="/lectures/14-pairwise-class/">Pairwise Contrasts</a></li>



  <li class=""><a href="/lectures/15-multiple-categorical/">Multiple Categorical Predictors</a></li>



  <li class=""><a href="/lectures/16-ancova/">Analysis of Covariance</a></li>



  <li class=""><a href="/lectures/17-categorical-interactions/">Categorical Interactions</a></li>

      
    

    
      </ul>
    

  
</nav>

    </div>

    
    
    <div class="d-none d-xl-block col-xl-2 docs-toc">
      <ul class="nav toc-top">
        <li><a href="#" id="back_to_top" class="docs-toc-title">Contents</a></li>
      </ul>

      

      
    </div>
    

    <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role="main">

      <article class="article">

        <div class="docs-article-container">
          

          <h1>Pairwise Contrasts</h1>

          <div class="article-style">
            
<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>

<div id="TOC">

</div>

<div id="more-details-on-pairwise-contrasts" class="section level1">
<h1>More details on pairwise contrasts</h1>
<p>Last week the idea of pairwise contrasts were introduced. Here is a more formal discussion of pairwise contrasts and controlling of familywise type I error rates.</p>
<div id="bonferroni-method" class="section level2">
<h2>Bonferroni Method</h2>
<p>This method is introduced first, primarily due to its simplicity. This is not the best measure to use however as will be discussed below. The Bonferroni method makes the following adjustment:</p>
<p><span class="math display">\[ 
\alpha_{new} = \frac{\alpha}{m}
\]</span></p>
<p>Where <span class="math inline">\(m\)</span> is the number of hypotheses being tested. Let’s use a specific example to frame this based on the baseball data.</p>
<pre class="r"><code>library(tidyverse)</code></pre>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──</code></pre>
<pre><code>## ✓ ggplot2 3.3.5     ✓ purrr   0.3.4
## ✓ tibble  3.1.5     ✓ dplyr   1.0.7
## ✓ tidyr   1.1.4     ✓ stringr 1.4.0
## ✓ readr   2.0.2     ✓ forcats 0.5.1</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>library(Lahman)
library(ggformula)</code></pre>
<pre><code>## Loading required package: ggstance</code></pre>
<pre><code>## 
## Attaching package: &#39;ggstance&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:ggplot2&#39;:
## 
##     geom_errorbarh, GeomErrorbarh</code></pre>
<pre><code>## Loading required package: scales</code></pre>
<pre><code>## 
## Attaching package: &#39;scales&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     discard</code></pre>
<pre><code>## The following object is masked from &#39;package:readr&#39;:
## 
##     col_factor</code></pre>
<pre><code>## Loading required package: ggridges</code></pre>
<pre><code>## 
## New to ggformula?  Try the tutorials: 
##  learnr::run_tutorial(&quot;introduction&quot;, package = &quot;ggformula&quot;)
##  learnr::run_tutorial(&quot;refining&quot;, package = &quot;ggformula&quot;)</code></pre>
<pre class="r"><code>theme_set(theme_bw(base_size = 18))

career &lt;- Batting %&gt;%
  filter(AB &gt; 100) %&gt;%
  anti_join(Pitching, by = &quot;playerID&quot;) %&gt;%
  filter(yearID &gt; 1990) %&gt;%
  group_by(playerID, lgID) %&gt;%
  summarise(H = sum(H), AB = sum(AB)) %&gt;%
  mutate(average = H / AB)</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;playerID&#39;. You can override using the `.groups` argument.</code></pre>
<pre class="r"><code>career &lt;- Appearances %&gt;%
  filter(yearID &gt; 1990) %&gt;%
  select(-GS, -G_ph, -G_pr, -G_batting, -G_defense, -G_p, -G_lf, -G_cf, -G_rf) %&gt;%
  rowwise() %&gt;%
  mutate(g_inf = sum(c_across(G_1b:G_ss))) %&gt;%
  select(-G_1b, -G_2b, -G_3b, -G_ss) %&gt;%
  group_by(playerID, lgID) %&gt;%
  summarise(catcher = sum(G_c),
            outfield = sum(G_of),
            dh = sum(G_dh),
            infield = sum(g_inf),
            total_games = sum(G_all)) %&gt;%
  pivot_longer(catcher:infield,
               names_to = &quot;position&quot;) %&gt;%
  filter(value &gt; 0) %&gt;%
  group_by(playerID, lgID) %&gt;%
  slice_max(value) %&gt;%
  select(playerID, lgID, position) %&gt;%
  inner_join(career)</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;playerID&#39;. You can override using the `.groups` argument.</code></pre>
<pre><code>## Joining, by = c(&quot;playerID&quot;, &quot;lgID&quot;)</code></pre>
<pre class="r"><code>career &lt;- Master %&gt;%
  tbl_df() %&gt;%
  dplyr::select(playerID, nameFirst, nameLast) %&gt;%
  unite(name, nameFirst, nameLast, sep = &quot; &quot;) %&gt;%
  inner_join(career, by = &quot;playerID&quot;)</code></pre>
<pre><code>## Warning: `tbl_df()` was deprecated in dplyr 1.0.0.
## Please use `tibble::as_tibble()` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was generated.</code></pre>
<pre class="r"><code>career &lt;- career %&gt;%
  mutate(league_dummy = ifelse(lgID == &#39;NL&#39;, 1, 0))

head(career)</code></pre>
<pre><code>## # A tibble: 6 × 8
##   playerID  name               lgID  position     H    AB average league_dummy
##   &lt;chr&gt;     &lt;chr&gt;              &lt;fct&gt; &lt;chr&gt;    &lt;int&gt; &lt;int&gt;   &lt;dbl&gt;        &lt;dbl&gt;
## 1 abbotje01 Jeff Abbott        AL    outfield   127   459   0.277            0
## 2 abbotku01 Kurt Abbott        AL    infield     33   123   0.268            0
## 3 abbotku01 Kurt Abbott        NL    infield    455  1780   0.256            1
## 4 abercre01 Reggie Abercrombie NL    outfield    54   255   0.212            1
## 5 abernbr01 Brent Abernathy    AL    infield    194   767   0.253            0
## 6 abnersh01 Shawn Abner        AL    outfield    81   309   0.262            0</code></pre>
<pre class="r"><code>position_lm &lt;- lm(average ~ 1 + position, data = career)

broom::tidy(position_lm)</code></pre>
<pre><code>## # A tibble: 4 × 5
##   term             estimate std.error statistic  p.value
##   &lt;chr&gt;               &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 (Intercept)        0.242    0.00142    170.   0       
## 2 positiondh         0.0161   0.00349      4.62 4.00e- 6
## 3 positioninfield    0.0132   0.00163      8.09 8.62e-16
## 4 positionoutfield   0.0146   0.00166      8.79 2.47e-18</code></pre>
<pre class="r"><code>count(career, position)</code></pre>
<pre><code>## # A tibble: 4 × 2
##   position     n
##   &lt;chr&gt;    &lt;int&gt;
## 1 catcher    397
## 2 dh          79
## 3 infield   1233
## 4 outfield  1096</code></pre>
<p>Given that there are 4 groups, if all pairwise comparisons were of interest, the following would be all possible <strong>NULL</strong> hypotheses. Note, I am assuming that each of these has a matching alternative hypothesis that states the groups differences are <em>different</em> from 0.</p>
<p><span class="math display">\[
H_{0}: \mu_{catcher} - \mu_{dh} = 0 \\
H_{0}: \mu_{catcher} - \mu_{infield} = 0 \\
H_{0}: \mu_{catcher} - \mu_{outfield} = 0 \\
H_{0}: \mu_{dh} - \mu_{infield} = 0 \\
H_{0}: \mu_{dh} - \mu_{outfield} = 0 \\
H_{0}: \mu_{infield} - \mu_{outfield} = 0 \\
\]</span></p>
<p><span class="math display">\[
H_{0}: \mu_{catcher} = \mu_{dh} \\
\]</span></p>
<p>In general, to find the total number of hypotheses, you can use the combinations formula:</p>
<p><span class="math display">\[
C(m, r) = \binom(m, r) = \frac{m!}{r!(m - r)!}
\]</span></p>
<p>For our example this would lead to:</p>
<p><span class="math display">\[
\binom(4, 2) = \frac{4!}{2!(4 - 2)!} = \frac{4 * 3 * 2 * 1}{2 * 1 * (2 * 1)} = \frac{24}{4} = 6
\]</span></p>
<p>Therefore, using bonferroni’s correction, our new alpha would be:</p>
<p><span class="math display">\[
\alpha_{new} = \frac{.05}{6} = .0083
\]</span></p>
<p>Alternatively, you could also adjust the p-values to make them smaller and still use .05 (or any other predetermined familywise <span class="math inline">\(\alpha\)</span> value).</p>
<p><span class="math display">\[
p_{new} = p_{original}*m
\]</span></p>
<p>This is what most software programs do automatically for you.</p>
<pre class="r"><code>pairwise.t.test(career$average, career$position, p.adjust = &#39;none&#39;)</code></pre>
<pre><code>## 
##  Pairwise comparisons using t tests with pooled SD 
## 
## data:  career$average and career$position 
## 
##          catcher dh   infield
## dh       4.0e-06 -    -      
## infield  8.6e-16 0.38 -      
## outfield &lt; 2e-16 0.64 0.25   
## 
## P value adjustment method: none</code></pre>
<pre class="r"><code>pairwise.t.test(career$average, career$position, p.adjust = &#39;bonf&#39;)</code></pre>
<pre><code>## 
##  Pairwise comparisons using t tests with pooled SD 
## 
## data:  career$average and career$position 
## 
##          catcher dh infield
## dh       2.4e-05 -  -      
## infield  5.2e-15 1  -      
## outfield &lt; 2e-16 1  1      
## 
## P value adjustment method: bonferroni</code></pre>
</div>
<div id="what-is-a-type-i-error" class="section level2">
<h2>What is a type I error?</h2>
<p>Before moving to why you should care, let’s more formally talk about type I errors. Suppose we have the following table of possible outcomes:</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right"><span class="math inline">\(H_{0}\)</span> true</th>
<th align="right"><span class="math inline">\(H_{0}\)</span> false</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Reject <span class="math inline">\(H_{0}\)</span></td>
<td align="right">Type I Error (<span class="math inline">\(\alpha\)</span>) - FP</td>
<td align="right">Correct - Power (<span class="math inline">\(1 - \beta\)</span>) - TP</td>
</tr>
<tr class="even">
<td align="left">Retain <span class="math inline">\(H_{0}\)</span></td>
<td align="right">Correct (<span class="math inline">\(1 - \alpha\)</span>) - TN</td>
<td align="right">Type II Error (<span class="math inline">\(\beta\)</span>) - FN</td>
</tr>
</tbody>
</table>
<p><strong>Type I error</strong> is when the null hypothesis is true in the population, but the statistical evidence <em>supports the alternative hypothesis</em>.
<strong>Type II error</strong> is when the null hypothesis is false in the population, but the statistical evidence <em>supports the null hypothesis</em>.</p>
<p>Here is a good link for an interactive app that shows many of these terms visually: <a href="https://rpsychologist.com/d3/nhst/" class="uri">https://rpsychologist.com/d3/nhst/</a>.</p>
</div>
<div id="holm-bonferroni-procedure" class="section level2">
<h2>Holm-Bonferroni Procedure</h2>
<p>The boneferroni procedure will be overly conservative and I wouldn’t recommend it’s use in practice. If you want a simple approach to p-value adjustment, I’d recommend just setting a specific value for the alpha value to be more conservative, for example setting it to 0.01.</p>
<p>The Holm-Bonferroni approach is an adjustment method that is more powerful then the original bonferroni procedure, but does not come with onerous assumptions. The Holm-Boneferroni procedure uses the following steps for adjustment.</p>
<p>Suppose there are <span class="math inline">\(m\)</span> p-values (ie, <span class="math inline">\(m\)</span> null hypotheses). First, order these from smallest to largest, be sure to keep track of which hypothese the p-value is associated with. Then,
1. Is the smallest p-value <strong>less than</strong> <span class="math inline">\(\alpha / m\)</span>, if yes, provide evidence for the alternative hypothesis and proceed to the next p-value, it not stop.
2. Is the second smallest p-value <strong>less than</strong> $ / m - 1$, if yes, provide evidence for the alternative hypothesis and proceed to the next p-value, if not stop.
3. Continue, comparing the p-values in order to the following adjust alpha,</p>
<p><span class="math display">\[
\alpha_{new_{k}} = \frac{\alpha}{m + 1 - k}
\]</span></p>
<p>where is <span class="math inline">\(k\)</span> is the rank of the p-values when ordered from smallest to largest.</p>
<p>Similar to the bonferroni, the p-values can be adjusted with the following formula:</p>
<p><span class="math display">\[
p_{adj} = min(1, max((m + 1 - k) * p_{k} ))
\]</span></p>
<p>where is <span class="math inline">\(k\)</span> is the rank of the p-values when ordered from smallest to largest.</p>
<pre class="r"><code>pairwise.t.test(career$average, career$position, p.adjust = &#39;holm&#39;)</code></pre>
<pre><code>## 
##  Pairwise comparisons using t tests with pooled SD 
## 
## data:  career$average and career$position 
## 
##          catcher dh   infield
## dh       1.6e-05 -    -      
## infield  4.3e-15 0.76 -      
## outfield &lt; 2e-16 0.76 0.74   
## 
## P value adjustment method: holm</code></pre>
<pre class="r"><code>pairwise.t.test(career$average, career$position, p.adjust = &#39;hochberg&#39;)$p.value</code></pre>
<pre><code>##               catcher        dh   infield
## dh       1.600322e-05        NA        NA
## infield  4.307875e-15 0.6423474        NA
## outfield 1.484622e-17 0.6423474 0.6423474</code></pre>
<pre class="r"><code>pairwise.t.test(career$average, career$position, p.adjust = &#39;none&#39;)$p.value[3] * (6 + 1 - 1)</code></pre>
<pre><code>## [1] 1.484622e-17</code></pre>
<pre class="r"><code>pairwise.t.test(career$average, career$position, p.adjust = &#39;none&#39;)$p.value[2] * (6 + 1 - 2)</code></pre>
<pre><code>## [1] 4.307875e-15</code></pre>
<pre class="r"><code>pairwise.t.test(career$average, career$position, p.adjust = &#39;none&#39;)$p.value[1] * (6 + 1 - 3)</code></pre>
<pre><code>## [1] 1.600322e-05</code></pre>
<pre class="r"><code>pairwise.t.test(career$average, career$position, p.adjust = &#39;none&#39;)$p.value[9] * (6 + 1 - 4)</code></pre>
<pre><code>## [1] 0.7390823</code></pre>
<pre class="r"><code>pairwise.t.test(career$average, career$position, p.adjust = &#39;none&#39;)$p.value[5] * (6 + 1 - 5)</code></pre>
<pre><code>## [1] 0.7568237</code></pre>
<pre class="r"><code>pairwise.t.test(career$average, career$position, p.adjust = &#39;none&#39;)$p.value[6] * (6 + 1 - 6)</code></pre>
<pre><code>## [1] 0.6423474</code></pre>
</div>
<div id="exploring-assumptions-for-model-with-categorical-attributes" class="section level2">
<h2>Exploring assumptions for model with categorical attributes</h2>
<pre class="r"><code>plot(position_lm, which = 1:5)</code></pre>
<p><img src="/lectures/14-pairwise-class_files/figure-html/unnamed-chunk-9-1.png" width="672" /><img src="/lectures/14-pairwise-class_files/figure-html/unnamed-chunk-9-2.png" width="672" /><img src="/lectures/14-pairwise-class_files/figure-html/unnamed-chunk-9-3.png" width="672" /><img src="/lectures/14-pairwise-class_files/figure-html/unnamed-chunk-9-4.png" width="672" /><img src="/lectures/14-pairwise-class_files/figure-html/unnamed-chunk-9-5.png" width="672" /></p>
<pre class="r"><code>broom::augment(position_lm) %&gt;%
  group_by(position) %&gt;%
  summarise(var = var(.resid))</code></pre>
<pre><code>## # A tibble: 4 × 2
##   position      var
##   &lt;chr&gt;       &lt;dbl&gt;
## 1 catcher  0.000795
## 2 dh       0.000907
## 3 infield  0.000837
## 4 outfield 0.000754</code></pre>
<pre class="r"><code>.00007539 * 3</code></pre>
<pre><code>## [1] 0.00022617</code></pre>
</div>
</div>

          </div>

          



          
          
          <div class="article-widget">
            
<div class="post-nav">
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Previous</div>
    <a href="/lectures/14-pairwise/" rel="next">Pairwise Contrasts</a>
  </div>
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Next</div>
    <a href="/lectures/15-multiple-categorical/" rel="prev">Multiple Categorical Predictors</a>
  </div>
  
</div>

          </div>
          
        </div>

        <div class="body-footer">
          <p>Last updated on Nov 8, 2021</p>

          



          




          


        </div>

      </article>

      <footer class="site-footer">
  

  <p class="powered-by">
    
  </p>

  
  






  <p class="powered-by">
    
    
    
    Published with
    <a href="https://wowchemy.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Wowchemy</a>  —
    the free, <a href="https://github.com/wowchemy/wowchemy-hugo-modules" target="_blank" rel="noopener">
    open source</a> website builder that empowers creators.
    
  </p>
</footer>


    </main>
  </div>
</div>

  </div>

  <div class="page-footer">
    
    
  </div>

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

      
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      

      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/instant.page/5.1.0/instantpage.min.js" integrity="sha512-1+qUtKoh9XZW7j+6LhRMAyOrgSQKenQ4mluTR+cvxXjP1Z54RxZuzstR/H9kgPXQsVB8IW7DMDFUJpzLjvhGSQ==" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js" integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/r.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.js" integrity="sha512-SeiQaaDh73yrb56sTW/RgVdi/mMqNeM2oBwubFHagc5BkixSpP1fvqF47mKzPGWYSSy4RwbBunrJBQ4Co8fRWA==" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'event' : "Events",
        'slides' : "Slides"
        };
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.2/anchor.min.js" integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin="anonymous"></script>
    <script>
      anchors.add();
    </script>
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    
    

    
    

    
    

    
    
    
    
    
    
    
    
    
    
      
      
    
    
    <script src="/js/wowchemy.min.d4185df71ecf716f1c4e7ef5f3d4e2b8.js"></script>

    






</body>
</html>
