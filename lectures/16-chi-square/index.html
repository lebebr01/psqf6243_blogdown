<!DOCTYPE html><html lang="en-us" >

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  
  
  <meta name="generator" content="Wowchemy 5.0.0-beta.1 for Hugo">
  

  

  
  

  
  
  
  
  
    
    
    
  
  

  

  
  
  
    
  
  <meta name="description" content="Chi-Square Tests There are a total of 2 different chi-square tests for categorical attributes.
Chi-square goodness of fit - Useful for 1 categorical attribute Chi-square test of independence - Useful for 2 categorical attributes  Let’s explore some data related to the General Social Survey.">

  
  <link rel="alternate" hreflang="en-us" href="https://psqf6243.brandonlebeau.org/lectures/16-chi-square/">

  







  




  
  
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  

  
  
  
  <meta name="theme-color" content="#1565c0">
  

  
  
  
  <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha256-FMvZuGapsJLjouA6k7Eo2lusoAX9i0ShlWFG6qt7SLc=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous" media="print" onload="this.media='all'">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github.min.css" crossorigin="anonymous" title="hl-light" media="print" onload="this.media='all'">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" media="print" onload="this.media='all'" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.css" integrity="sha512-1xoFisiGdy9nvho8EgXuXvnpR5GAMSjFwp40gSRE3NwdUdIMIKuPa7bqoUhLD0O/5tPNhteAsE5XyyMi5reQVA==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.2.2/lazysizes.min.js" integrity="sha512-TmDwFLhg3UA4ZG0Eb4MIyT1O1Mb+Oww5kFG0uHqXsdbyZz9DcvYQhKpGgNkamAI6h2lGGZq2X8ftOJvF/XjTUg==" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    

  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.3aad675291f323c3cd47ae187f0bf0d6.css">

  




  

  


  
  

  

  
  <link rel="manifest" href="/index.webmanifest">
  

  <link rel="icon" type="image/png" href="/images/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_32x32_fill_lanczos_center_3.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_192x192_fill_lanczos_center_3.png">

  <link rel="canonical" href="https://psqf6243.brandonlebeau.org/lectures/16-chi-square/">

  
  
  
  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="og:site_name" content="PSQF 6243">
  <meta property="og:url" content="https://psqf6243.brandonlebeau.org/lectures/16-chi-square/">
  <meta property="og:title" content="Chi-Square Tests | PSQF 6243">
  <meta property="og:description" content="Chi-Square Tests There are a total of 2 different chi-square tests for categorical attributes.
Chi-square goodness of fit - Useful for 1 categorical attribute Chi-square test of independence - Useful for 2 categorical attributes  Let’s explore some data related to the General Social Survey."><meta property="og:image" content="https://psqf6243.brandonlebeau.org/media/blue-balloon.jpg">
  <meta property="twitter:image" content="https://psqf6243.brandonlebeau.org/media/blue-balloon.jpg"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2023-11-16T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2023-11-16T00:00:00&#43;00:00">
  

  



  


  


  





  <title>Chi-Square Tests | PSQF 6243</title>

</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper  ">

  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.7de282f2047be3c570af3a58788341e7.js"></script>

  

<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="Search...">
        
      </div>

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header">
    












<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">PSQF 6243</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">PSQF 6243</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#logistics"><span>Logistics</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/syllabus/"><span>Syllabus</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/schedule/"><span>Schedule</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/content/"><span>Content</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link  active" href="/lectures/"><span>Lecture Notes</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/assignments/"><span>Assignments</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/code/"><span>Software Resources</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#people"><span>People</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

      
      
        
      

      
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true" aria-label="Display preferences">
          <i class="fas fa-moon" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      

    </ul>

  </div>
</nav>


  </div>

  <div class="page-body">
    





<div class="container-fluid docs">
  <div class="row flex-xl-nowrap">
    <div class="col-12 col-md-3 col-xl-2 docs-sidebar">
      <form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-3" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <span><i class="fas fa-bars"></i></span>
  </button>

  
  <button class="form-control sidebar-search js-search">
    <i class="fas fa-search pr-2"></i>
    <span class="sidebar-search-text">Search...</span>
    <span class="sidebar-search-shortcut">/</span>
  </button>
  
</form>

<nav class="collapse docs-links" id="docs-nav">
  
  
  
  
  
  

  
  
    

    
      

      
      
      


  
    
    
    
    
      
    
    

    
      <ul class="nav docs-sidenav">
        <li class=""><a href="/lectures/">Lecture Notes</a></li>
    
      


  <li class=""><a href="/lectures/01-review/">Review</a></li>



  <li class=""><a href="/lectures/02-linear-regression/">Introduction to Linear Regression</a></li>



  <li class=""><a href="/lectures/02a-in-class-activity/">Linear Regression - In Class</a></li>



  <li class=""><a href="/lectures/03-regression-estimates/">Regression Estimation</a></li>



  <li class=""><a href="/lectures/04-least-squares-simulation/">Least Squares Minimization</a></li>



  <li class=""><a href="/lectures/05-regression-inference/">Inference for regression parameters</a></li>



  <li class=""><a href="/lectures/05a-regression-in-class/">Regression in class</a></li>



  <li class=""><a href="/lectures/06-regression-conditions/">Conditions for Linear Regression</a></li>



  <li class=""><a href="/lectures/07-bootstrap/">Bootstrap</a></li>



  <li class=""><a href="/lectures/07-bootstrap-class/">Bootstrap - In Class Portion</a></li>



  <li class=""><a href="/lectures/08-multiple-regression-class/">Multiple Regression - In Class Notes</a></li>



  <li class=""><a href="/lectures/08-multiple-regression/">Multiple Regression</a></li>



  <li class=""><a href="/lectures/09-model-comparison/">Multiple Comparisons</a></li>



  <li class=""><a href="/lectures/10-regression-categorical/">Regression with Categorical Predictors</a></li>



  <li class=""><a href="/lectures/11-pairwise/">Pairwise Contrasts</a></li>



  <li class=""><a href="/lectures/12-multiple-categorical/">Multiple Categorical Predictors</a></li>



  <li class=""><a href="/lectures/13-ancova/">Analysis of Covariance</a></li>



  <li class=""><a href="/lectures/14-prepost/">Pre / Post Designs</a></li>



  <li class=""><a href="/lectures/15-non-linear/">Non-Linear Trends</a></li>



  <li class="active"><a href="/lectures/16-chi-square/">Chi-Square Tests</a></li>



  <li class=""><a href="/lectures/02-linear-regression-inclass/">Linear Regression - In Class</a></li>

      
    

    
      </ul>
    

  
</nav>

    </div>

    
    
    <div class="d-none d-xl-block col-xl-2 docs-toc">
      <ul class="nav toc-top">
        <li><a href="#" id="back_to_top" class="docs-toc-title">Contents</a></li>
      </ul>

      

      
    </div>
    

    <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role="main">

      <article class="article">

        <div class="docs-article-container">
          

          <h1>Chi-Square Tests</h1>

          <div class="article-style">
            

<div id="TOC">

</div>

<div id="chi-square-tests" class="section level1">
<h1>Chi-Square Tests</h1>
<p>There are a total of 2 different chi-square tests for categorical attributes.</p>
<ol style="list-style-type: decimal">
<li>Chi-square goodness of fit - Useful for 1 categorical attribute</li>
<li>Chi-square test of independence - Useful for 2 categorical attributes</li>
</ol>
<p>Let’s explore some data related to the <a href="https://gss.norc.org/">General Social Survey</a>.</p>
<pre class="r"><code>library(tidyverse)</code></pre>
<pre><code>## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
## ✔ dplyr     1.1.2     ✔ readr     2.1.4
## ✔ forcats   1.0.0     ✔ stringr   1.5.0
## ✔ ggplot2   3.4.3     ✔ tibble    3.2.1
## ✔ lubridate 1.9.2     ✔ tidyr     1.3.0
## ✔ purrr     1.0.1     
## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()
## ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
<pre class="r"><code>head(gss_cat)</code></pre>
<pre><code>## # A tibble: 6 × 9
##    year marital         age race  rincome        partyid     relig denom tvhours
##   &lt;int&gt; &lt;fct&gt;         &lt;int&gt; &lt;fct&gt; &lt;fct&gt;          &lt;fct&gt;       &lt;fct&gt; &lt;fct&gt;   &lt;int&gt;
## 1  2000 Never married    26 White $8000 to 9999  Ind,near r… Prot… Sout…      12
## 2  2000 Divorced         48 White $8000 to 9999  Not str re… Prot… Bapt…      NA
## 3  2000 Widowed          67 White Not applicable Independent Prot… No d…       2
## 4  2000 Never married    39 White Not applicable Ind,near r… Orth… Not …       4
## 5  2000 Divorced         25 White Not applicable Not str de… None  Not …       1
## 6  2000 Married          25 White $20000 - 24999 Strong dem… Prot… Sout…      NA</code></pre>
<div id="chi-square-goodness-of-fit" class="section level2">
<h2>Chi-square goodness of fit</h2>
<p>Suppose we were interested in knowing if the proportion of people from the GSS data are similar to the political affiliation currently in the United States. This link gives the breakdown of the <a href="https://news.gallup.com/poll/15370/party-affiliation.aspx">current political affiliation in the United States</a> according to a continuously running Gallup poll.</p>
<p>The chi-square goodness of fit explores the extent to which a categorical attribute follows a specified distribution. The chi-square goodness of fit test is often framed as a way to evaluate if the sample data is representative of the population. As such, the following hypotheses would be a way to frame this analysis.</p>
<p><span class="math display">\[
H_{0}:\ All\ categories\ follow\ the\ population\ distribution
\]</span></p>
<p>or</p>
<p><span class="math display">\[
H_{0}:\ All\ categories\ follow\ the\ specified\ percentages\ or\ proportions
\]</span></p>
<p>To frame this analysis in the context of the current data, let’s look at the <code>partyid</code> attribute in the data.</p>
<pre class="r"><code>count(gss_cat, partyid) %&gt;%
  mutate(prop = n / sum(n))</code></pre>
<pre><code>## # A tibble: 10 × 3
##    partyid                n      prop
##    &lt;fct&gt;              &lt;int&gt;     &lt;dbl&gt;
##  1 No answer            154 0.00717  
##  2 Don&#39;t know             1 0.0000465
##  3 Other party          393 0.0183   
##  4 Strong republican   2314 0.108    
##  5 Not str republican  3032 0.141    
##  6 Ind,near rep        1791 0.0834   
##  7 Independent         4119 0.192    
##  8 Ind,near dem        2499 0.116    
##  9 Not str democrat    3690 0.172    
## 10 Strong democrat     3490 0.162</code></pre>
<p>For this example, I’m going to collapse categories and assign a few to NA to omit from the analysis. The following code does this task and then returns a similar table to that shown above. In particular, since the Gallup poll only includes asks about republicans, independents, or democrats, I’m going to group others into an “other” category.</p>
<pre class="r"><code>gss_cat &lt;- gss_cat %&gt;%
  mutate(partyid_collapse = fct_collapse(partyid,
    other = c(&quot;No answer&quot;, &quot;Don&#39;t know&quot;, &quot;Other party&quot;),
    rep = c(&quot;Strong republican&quot;, &quot;Not str republican&quot;),
    ind = c(&quot;Ind,near rep&quot;, &quot;Independent&quot;, &quot;Ind,near dem&quot;),
    dem = c(&quot;Not str democrat&quot;, &quot;Strong democrat&quot;)
  ))

count(gss_cat, partyid_collapse) %&gt;%
  mutate(prop = n / sum(n))</code></pre>
<pre><code>## # A tibble: 4 × 3
##   partyid_collapse     n   prop
##   &lt;fct&gt;            &lt;int&gt;  &lt;dbl&gt;
## 1 other              548 0.0255
## 2 rep               5346 0.249 
## 3 ind               8409 0.391 
## 4 dem               7180 0.334</code></pre>
<div id="chi-square-gof-mechanics" class="section level3">
<h3>Chi-Square GoF Mechanics</h3>
<p>The chi-square goodness of fit compares the observed cell counts with the expected cell counts. More formally, the chi-square test statistic is as follows:</p>
<p><span class="math display">\[
\chi^2 = \sum \frac{( O - E ) ^ 2}{E}
\]</span></p>
<p>where <span class="math inline">\(O\)</span> is the observed cell counts and <span class="math inline">\(E\)</span> are the expected cell counts. The expected cell counts are defined as the sample size times the hypothesized proportions/percentages (this is not completely statistically accurate, however, in many social science situations, this should be sufficient). For example:</p>
<p><span class="math display">\[
E = p_{H_{0}} * N
\]</span></p>
<p>where <span class="math inline">\(p_{H_{0}}\)</span> is the hypothesized proportions from the null hypothesis. The <span class="math inline">\(\chi^2\)</span> statistic follows a chi-square distribution with <span class="math inline">\(k - 1\)</span> degrees of freedom, where <span class="math inline">\(k\)</span> is the number of categories.</p>
<p>Using the table above, these can be computed from the data and assuming the following as population proportions/percentages from the Gallup poll: Rep = 27%, Ind = 45%, Dem = 27%, other = 1%.</p>
<pre class="r"><code>chi_tab &lt;- count(gss_cat, partyid_collapse) %&gt;%
  mutate(prop = n / sum(n), 
         prop_h0 = c(.01, .27, .45, .27),
         E = prop_h0 * sum(n))

chi_tab</code></pre>
<pre><code>## # A tibble: 4 × 5
##   partyid_collapse     n   prop prop_h0     E
##   &lt;fct&gt;            &lt;int&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
## 1 other              548 0.0255    0.01  215.
## 2 rep               5346 0.249     0.27 5800.
## 3 ind               8409 0.391     0.45 9667.
## 4 dem               7180 0.334     0.27 5800.</code></pre>
<p>The <span class="math inline">\(\chi^2\)</span> statistic can be computed manually.</p>
<pre class="r"><code>chi_tab %&gt;%
  mutate(num = (n - E)^2,
         chi_cell = num / E) %&gt;%
  summarise(chi_square = sum(chi_cell))</code></pre>
<pre><code>## # A tibble: 1 × 1
##   chi_square
##        &lt;dbl&gt;
## 1      1044.</code></pre>
<p>More readily, using the <code>chisq.test()</code> function in R is easier. This function takes one primary argument, the attribute to do the chi-square goodness of fit test on. Optionally, the specific proportions need to be passed as well, which is typically desired unless equal percentages/proportions are desired.</p>
<pre class="r"><code>xsq_got &lt;- chisq.test(table(gss_cat$partyid_collapse), p = c(.01, .27, .45, .27))

xsq_got</code></pre>
<pre><code>## 
## 	Chi-squared test for given probabilities
## 
## data:  table(gss_cat$partyid_collapse)
## X-squared = 1044.2, df = 3, p-value &lt; 2.2e-16</code></pre>
</div>
<div id="explore-differences" class="section level3">
<h3>Explore Differences</h3>
<p>It is often of interest to explore differences, particularly if the chi-square goodness of fit test has a small p-value. This would indicate that the counts likely do not follow the assumed distribution, but where are the differences found? Residuals can help with this. The residuals are the difference in the observed and expected values divided by the square root of the expected values.</p>
<p><span class="math display">\[
\chi^2_{resid} = \frac{(O - E)}{\sqrt{E}}
\]</span></p>
<p>These can be extracted directly from the model object saved when running the chi-square test.</p>
<pre class="r"><code>xsq_got$residuals</code></pre>
<pre><code>## 
##      other        rep        ind        dem 
##  22.730994  -5.966485 -12.798166  18.114264</code></pre>
</div>
</div>
<div id="chi-square-test-of-independence" class="section level2">
<h2>Chi-square Test of Independence</h2>
<p>The chi-square test of independence is similar to that of the goodness of fit test, except now instead of a single attribute of interest, there are now more than one categorical attribute to be explored. The test of independence explores if the observed attributes are independent from one another. That is, if the two categorical attributes are indpendent, this would assume that the two attributes are proportionally distributed across all categories. The form of the <span class="math inline">\(\chi^2\)</span> test is the same as the GoT test:</p>
<p><span class="math display">\[
\chi^2 = \sum \frac{( O - E ) ^ 2}{E}
\]</span></p>
<p>However, different from the goodness of fit test, the expected values are computed differently. The expected cell counts are now defined as:</p>
<p><span class="math display">\[
E = N * p_{r} * p_{c}
\]</span></p>
<p>where <span class="math inline">\(p_{r}\)</span> is the margin proportion for the rows, ignoring the columns (that is, marginal row proportion) and <span class="math inline">\(p_{c}\)</span> is the margin proportion for the columns, ignoring the rows. Finally, the test has degrees of freedom equal to <span class="math inline">\((r - 1)(c - 1)\)</span>.</p>
<div id="data-example" class="section level3">
<h3>Data Example</h3>
<p>To explore this example, let’s see if the political party affiliation differs (or is associated with) across years that the GSS data were collected. The data are collected over 14 years, collected every other year.</p>
<pre class="r"><code>count(gss_cat, year)</code></pre>
<pre><code>## # A tibble: 8 × 2
##    year     n
##   &lt;int&gt; &lt;int&gt;
## 1  2000  2817
## 2  2002  2765
## 3  2004  2812
## 4  2006  4510
## 5  2008  2023
## 6  2010  2044
## 7  2012  1974
## 8  2014  2538</code></pre>
<p>Suppose we were interested in exploring if there was a difference in political affiliation before and after 2010.</p>
<pre class="r"><code>gss_cat &lt;- gss_cat %&gt;%
  mutate(year_2 = ifelse(year &lt; 2010, &quot;2000 to 2008&quot;, &quot;2010 to 2014&quot;))

addmargins(table(gss_cat$year_2, gss_cat$partyid_collapse))</code></pre>
<pre><code>##               
##                other   rep   ind   dem   Sum
##   2000 to 2008   327  3906  5734  4960 14927
##   2010 to 2014   221  1440  2675  2220  6556
##   Sum            548  5346  8409  7180 21483</code></pre>
<p>Giving this table, a single expected value could be computed manually.</p>
<p><span class="math display">\[
E_{1,1} = 21483 * (14927 / 21483) * (548 / 21483) = 380.766
\]</span></p>
<pre class="r"><code>21483 * (14927 / 21483) * (548 / 21483)</code></pre>
<pre><code>## [1] 380.766</code></pre>
<p>These could be computed for subsequent cell expected values, but these can be extracted directly when fitting the chi-square using the <code>chisq.test()</code> function.</p>
<pre class="r"><code>xsq_ind &lt;- chisq.test(table(gss_cat$year_2, gss_cat$partyid_collapse))

xsq_ind$expected</code></pre>
<pre><code>##               
##                  other      rep      ind      dem
##   2000 to 2008 380.766 3714.553 5842.813 4988.868
##   2010 to 2014 167.234 1631.447 2566.187 2191.132</code></pre>
<pre class="r"><code>xsq_ind</code></pre>
<pre><code>## 
## 	Pearson&#39;s Chi-squared test
## 
## data:  table(gss_cat$year_2, gss_cat$partyid_collapse)
## X-squared = 64.399, df = 3, p-value = 6.745e-14</code></pre>
<pre class="r"><code>xsq_ind$residuals</code></pre>
<pre><code>##               
##                     other        rep        ind        dem
##   2000 to 2008 -2.7553619  3.1411979 -1.4235351 -0.4087162
##   2010 to 2014  4.1576263 -4.7398226  2.1480035  0.6167208</code></pre>
</div>
</div>
<div id="effect-sizes-for-chi-square-tests" class="section level2">
<h2>Effect Sizes for chi-square tests</h2>
<p>Effect sizes for chi-square tests can be important, particularly with large sample sizes as the chi-square can be highly sensitive to large sample sizes. In particular, very small differences can be found with small samples sizes.</p>
<p>For the goodness of fit test, <span class="math inline">\(Cohens\ W\)</span> can be estimated as an effect size measure. This is computed as:</p>
<p><span class="math display">\[
Cohens\ W = \sqrt{\frac{\chi^2}{N}}
\]</span></p>
<p>For the test of independence, Cramer’s V can be used.</p>
<p><span class="math display">\[
V = \sqrt{\frac{\chi^2}{N * df^{*}}}
\]</span>
where <span class="math inline">\(df^{*}\)</span> is the smallest of <span class="math inline">\(r - 1\)</span> or <span class="math inline">\(c - 1\)</span>.</p>
<p>Cramers V ranges from 0 to 1, where values closer to 1 indicate more variation is explained (ie, the attributes are not independent).</p>
<p>Cohen’s W is similar to Cramers V, but it is not limited to range between 0 and 1.</p>
<pre class="r"><code>sqrt(693.4 / sum(chi_tab$n))</code></pre>
<pre><code>## [1] 0.1796571</code></pre>
<pre class="r"><code>sqrt(64.399 / 21483 * 1)</code></pre>
<pre><code>## [1] 0.05475101</code></pre>
<p>The DescTools package can be used for Cramer’s V as well.</p>
<pre class="r"><code>#install.packages(&quot;DescTools&quot;)
library(DescTools)

CramerV(table(gss_cat$year_2, gss_cat$partyid_collapse))</code></pre>
<pre><code>## [1] 0.05475087</code></pre>
</div>
</div>

          </div>

          



          
          
          <div class="article-widget">
            
<div class="post-nav">
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Previous</div>
    <a href="/lectures/15-non-linear/" rel="next">Non-Linear Trends</a>
  </div>
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Next</div>
    <a href="/lectures/02-linear-regression-inclass/" rel="prev">Linear Regression - In Class</a>
  </div>
  
</div>

          </div>
          
        </div>

        <div class="body-footer">
          <p>Last updated on Nov 16, 2023</p>

          



          




          


        </div>

      </article>

      <footer class="site-footer">
  

  <p class="powered-by">
    
  </p>

  
  






  <p class="powered-by">
    
    
    
    Published with
    <a href="https://wowchemy.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Wowchemy</a>  —
    the free, <a href="https://github.com/wowchemy/wowchemy-hugo-modules" target="_blank" rel="noopener">
    open source</a> website builder that empowers creators.
    
  </p>
</footer>


    </main>
  </div>
</div>

  </div>

  <div class="page-footer">
    
    
  </div>

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

      
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      

      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/instant.page/5.1.0/instantpage.min.js" integrity="sha512-1+qUtKoh9XZW7j+6LhRMAyOrgSQKenQ4mluTR+cvxXjP1Z54RxZuzstR/H9kgPXQsVB8IW7DMDFUJpzLjvhGSQ==" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js" integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/r.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.js" integrity="sha512-SeiQaaDh73yrb56sTW/RgVdi/mMqNeM2oBwubFHagc5BkixSpP1fvqF47mKzPGWYSSy4RwbBunrJBQ4Co8fRWA==" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'event' : "Events",
        'slides' : "Slides"
        };
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.2/anchor.min.js" integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin="anonymous"></script>
    <script>
      anchors.add();
    </script>
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    
    

    
    

    
    

    
    
    
    
    
    
    
    
    
    
      
      
    
    
    <script src="/js/wowchemy.min.d4185df71ecf716f1c4e7ef5f3d4e2b8.js"></script>

    






</body>
</html>
