<!DOCTYPE html><html lang="en-us" >

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  
  
  <meta name="generator" content="Wowchemy 5.0.0-beta.1 for Hugo">
  

  

  
  

  
  
  
  
  
    
    
    
  
  

  

  
  
  
    
  
  <meta name="description" content="Multicollinearity">

  
  <link rel="alternate" hreflang="en-us" href="https://psqf6243.brandonlebeau.org/lectures/11-multicollinearity/">

  







  




  
  
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  

  
  
  
  <meta name="theme-color" content="#1565c0">
  

  
  
  
  <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha256-FMvZuGapsJLjouA6k7Eo2lusoAX9i0ShlWFG6qt7SLc=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous" media="print" onload="this.media='all'">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github.min.css" crossorigin="anonymous" title="hl-light" media="print" onload="this.media='all'">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" media="print" onload="this.media='all'" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.css" integrity="sha512-1xoFisiGdy9nvho8EgXuXvnpR5GAMSjFwp40gSRE3NwdUdIMIKuPa7bqoUhLD0O/5tPNhteAsE5XyyMi5reQVA==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.2.2/lazysizes.min.js" integrity="sha512-TmDwFLhg3UA4ZG0Eb4MIyT1O1Mb+Oww5kFG0uHqXsdbyZz9DcvYQhKpGgNkamAI6h2lGGZq2X8ftOJvF/XjTUg==" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    

  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.3aad675291f323c3cd47ae187f0bf0d6.css">

  




  

  


  
  

  

  
  <link rel="manifest" href="/index.webmanifest">
  

  <link rel="icon" type="image/png" href="/images/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_32x32_fill_lanczos_center_3.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_192x192_fill_lanczos_center_3.png">

  <link rel="canonical" href="https://psqf6243.brandonlebeau.org/lectures/11-multicollinearity/">

  
  
  
  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="og:site_name" content="PSQF 6243">
  <meta property="og:url" content="https://psqf6243.brandonlebeau.org/lectures/11-multicollinearity/">
  <meta property="og:title" content="Multicollinearity | PSQF 6243">
  <meta property="og:description" content="Multicollinearity"><meta property="og:image" content="https://psqf6243.brandonlebeau.org/media/blue-balloon.jpg">
  <meta property="twitter:image" content="https://psqf6243.brandonlebeau.org/media/blue-balloon.jpg"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2021-10-13T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2021-10-13T00:00:00&#43;00:00">
  

  



  


  


  





  <title>Multicollinearity | PSQF 6243</title>

</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper  ">

  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.7de282f2047be3c570af3a58788341e7.js"></script>

  

<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="Search...">
        
      </div>

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header">
    












<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">PSQF 6243</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">PSQF 6243</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#logistics"><span>Logistics</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/syllabus/"><span>Syllabus</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/schedule/"><span>Schedule</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/content/"><span>Content</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link  active" href="/lectures/"><span>Lecture Notes</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/assignments/"><span>Assignments</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/code/"><span>Software Resources</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#people"><span>People</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

      
      
        
      

      
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true" aria-label="Display preferences">
          <i class="fas fa-moon" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      

    </ul>

  </div>
</nav>


  </div>

  <div class="page-body">
    





<div class="container-fluid docs">
  <div class="row flex-xl-nowrap">
    <div class="col-12 col-md-3 col-xl-2 docs-sidebar">
      <form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-3" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <span><i class="fas fa-bars"></i></span>
  </button>

  
  <button class="form-control sidebar-search js-search">
    <i class="fas fa-search pr-2"></i>
    <span class="sidebar-search-text">Search...</span>
    <span class="sidebar-search-shortcut">/</span>
  </button>
  
</form>

<nav class="collapse docs-links" id="docs-nav">
  
  
  
  
  
  

  
  
    

    
      

      
      
      


  
    
    
    
    
      
    
    

    
      <ul class="nav docs-sidenav">
        <li class=""><a href="/lectures/">Lecture Notes</a></li>
    
      


  <li class=""><a href="/lectures/review/">Review</a></li>



  <li class=""><a href="/lectures/review-class/">Review - class</a></li>



  <li class=""><a href="/lectures/intro-regression/">Intro to Linear Regression</a></li>



  <li class=""><a href="/lectures/linear-regression-class/">Intro to Linear Regression - class</a></li>



  <li class=""><a href="/lectures/regression-estimates/">Linear Regression Estimates</a></li>



  <li class=""><a href="/lectures/regression-estimates-class/">Linear Regression Estimates - class</a></li>



  <li class=""><a href="/lectures/least-squares-simulation/">Least Square Simulation</a></li>



  <li class=""><a href="/lectures/regression-inference-p1/">Regression Inference - Part 1</a></li>



  <li class=""><a href="/lectures/05-regression-inference/">Regression Inference - Part 1</a></li>



  <li class=""><a href="/lectures/05a-regression-inference/">Regression Inference - Part 2</a></li>



  <li class=""><a href="/lectures/05a-regression-inference-class/">Regression Inference - Part 2 - Class</a></li>



  <li class=""><a href="/lectures/06-t-vs-norm/">t vs Normal</a></li>



  <li class=""><a href="/lectures/07-regression-assumptions/">Regression Assumptions</a></li>



  <li class=""><a href="/lectures/07a-regression-assumptions/">Regression Assumptions - New Package</a></li>



  <li class=""><a href="/lectures/08-bootstrap/">Regression Bootstrap</a></li>



  <li class=""><a href="/lectures/08-bootstrap-class/">Regression Bootstrap - Class</a></li>



  <li class=""><a href="/lectures/09-multiple-regression-p1/">Multiple Regression - Part 1</a></li>



  <li class=""><a href="/lectures/09-multiple-regression-p1-class/">Multiple Regression - Part 1</a></li>



  <li class=""><a href="/lectures/10-model-comparison/">Model Comparison</a></li>



  <li class=""><a href="/lectures/10-model-comparison-class/">Model Comparison</a></li>



  <li class="active"><a href="/lectures/11-multicollinearity/">Multicollinearity</a></li>



  <li class=""><a href="/lectures/11-multicollinearity-class/">Multicollinearity</a></li>



  <li class=""><a href="/lectures/12-regression-categorical/">Regression Categorical Predictors</a></li>



  <li class=""><a href="/lectures/12-regression-categorical-class/">Regression Categorical Predictors</a></li>



  <li class=""><a href="/lectures/13-regression-categorical-p2/">Regression Categorical Predictors - p2</a></li>



  <li class=""><a href="/lectures/13-regression-categorical-p2-class/">Regression Categorical Predictors - p2</a></li>



  <li class=""><a href="/lectures/14-pairwise/">Pairwise Contrasts</a></li>



  <li class=""><a href="/lectures/14-pairwise-class/">Pairwise Contrasts</a></li>



  <li class=""><a href="/lectures/15-multiple-categorical/">Multiple Categorical Predictors</a></li>



  <li class=""><a href="/lectures/15-multiple-categorical-class/">Multiple Categorical Predictors - Class</a></li>



  <li class=""><a href="/lectures/16-ancova/">Analysis of Covariance</a></li>



  <li class=""><a href="/lectures/16-ancova-class/">Analysis of Covariance - Class</a></li>



  <li class=""><a href="/lectures/17-categorical-interactions/">Categorical Interactions</a></li>



  <li class=""><a href="/lectures/17-categorical-interactions-class/">Categorical Interactions - Class</a></li>



  <li class=""><a href="/lectures/18-chi-square/">Chi-Square</a></li>



  <li class=""><a href="/lectures/18-chi-square-class/">Chi-Square - Class</a></li>



  <li class=""><a href="/lectures/19-power/">Power</a></li>

      
    

    
      </ul>
    

  
</nav>

    </div>

    
    
    <div class="d-none d-xl-block col-xl-2 docs-toc">
      <ul class="nav toc-top">
        <li><a href="#" id="back_to_top" class="docs-toc-title">Contents</a></li>
      </ul>

      

      
    </div>
    

    <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role="main">

      <article class="article">

        <div class="docs-article-container">
          

          <h1>Multicollinearity</h1>

          <div class="article-style">
            
<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>

<div id="TOC">

</div>

<div id="multicollinearity" class="section level1">
<h1>Multicollinearity</h1>
<p>Multicollinearity is an assumption of regression that explores whether the predictor attributes (X) are correlated. Linear regression assumes that the predictor attributes are uncorrelated, but in practice this assumption is never met. What impacts does multicollinearity have on the linear regression? The short answer is that the regression parameters (the <span class="math inline">\(\beta\)</span> terms) will be more or less unbiased, however, the same cannot be said for the standard errors.</p>
<p>Let’s first use some real data to explore this, then we’ll use simulated data to show the impact correlated predictor attributes have on the linear regression estiamtes.</p>
<pre class="r"><code>library(tidyverse)</code></pre>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──</code></pre>
<pre><code>## ✓ ggplot2 3.3.5     ✓ purrr   0.3.4
## ✓ tibble  3.1.6     ✓ dplyr   1.0.7
## ✓ tidyr   1.1.4     ✓ stringr 1.4.0
## ✓ readr   2.1.0     ✓ forcats 0.5.1</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>library(ggformula)</code></pre>
<pre><code>## Loading required package: ggstance</code></pre>
<pre><code>## 
## Attaching package: &#39;ggstance&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:ggplot2&#39;:
## 
##     geom_errorbarh, GeomErrorbarh</code></pre>
<pre><code>## Loading required package: scales</code></pre>
<pre><code>## 
## Attaching package: &#39;scales&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     discard</code></pre>
<pre><code>## The following object is masked from &#39;package:readr&#39;:
## 
##     col_factor</code></pre>
<pre><code>## Loading required package: ggridges</code></pre>
<pre><code>## 
## New to ggformula?  Try the tutorials: 
##  learnr::run_tutorial(&quot;introduction&quot;, package = &quot;ggformula&quot;)
##  learnr::run_tutorial(&quot;refining&quot;, package = &quot;ggformula&quot;)</code></pre>
<pre class="r"><code>theme_set(theme_bw(base_size = 18))

college &lt;- read_csv(&quot;https://raw.githubusercontent.com/lebebr01/statthink/main/data-raw/College-scorecard-4143.csv&quot;) %&gt;%
  mutate(act_mean = actcmmid - mean(actcmmid, na.rm = TRUE),
         cost_mean = costt4_a - mean(costt4_a, na.rm = TRUE)) %&gt;%
  drop_na(act_mean, cost_mean)</code></pre>
<pre><code>## Rows: 7058 Columns: 16</code></pre>
<pre><code>## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr  (6): instnm, city, stabbr, preddeg, region, locale
## dbl (10): adm_rate, actcmmid, ugds, costt4_a, costt4_p, tuitionfee_in, tuiti...</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<pre class="r"><code>adm_mult_reg &lt;- lm(adm_rate ~ actcmmid + costt4_a, data = college)

summary(adm_mult_reg)</code></pre>
<pre><code>## 
## Call:
## lm(formula = adm_rate ~ actcmmid + costt4_a, data = college)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.65484 -0.12230  0.02291  0.13863  0.37054 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  1.135e+00  3.326e-02  34.130  &lt; 2e-16 ***
## actcmmid    -1.669e-02  1.650e-03 -10.114  &lt; 2e-16 ***
## costt4_a    -2.304e-06  4.047e-07  -5.693 1.55e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1813 on 1278 degrees of freedom
## Multiple R-squared:  0.1836, Adjusted R-squared:  0.1824 
## F-statistic: 143.8 on 2 and 1278 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>library(mosaic)</code></pre>
<pre><code>## Registered S3 method overwritten by &#39;mosaic&#39;:
##   method                           from   
##   fortify.SpatialPolygonsDataFrame ggplot2</code></pre>
<pre><code>## 
## The &#39;mosaic&#39; package masks several functions from core packages in order to add 
## additional features.  The original behavior of these functions should not be affected by this.</code></pre>
<pre><code>## 
## Attaching package: &#39;mosaic&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:Matrix&#39;:
## 
##     mean</code></pre>
<pre><code>## The following object is masked from &#39;package:scales&#39;:
## 
##     rescale</code></pre>
<pre><code>## The following objects are masked from &#39;package:dplyr&#39;:
## 
##     count, do, tally</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     cross</code></pre>
<pre><code>## The following object is masked from &#39;package:ggplot2&#39;:
## 
##     stat</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     binom.test, cor, cor.test, cov, fivenum, IQR, median, prop.test,
##     quantile, sd, t.test, var</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     max, mean, min, prod, range, sample, sum</code></pre>
<pre class="r"><code>cor(actcmmid ~ costt4_a, data = college)</code></pre>
<pre><code>## [1] 0.5557307</code></pre>
<div id="variance-inflation-factor" class="section level2">
<h2>Variance Inflation Factor</h2>
<p>The variance inflation factor (VIF) is a commonly used statistic to aid in diagnosing multicollinearity. It attempts to estimate how much the variance of the estimated regression equation is inflated due to correlated predictor attributes.</p>
<p>First, this can be calculated from the car package, using the function <code>vif()</code>.</p>
<pre class="r"><code>library(car)</code></pre>
<pre><code>## Loading required package: carData</code></pre>
<pre><code>## 
## Attaching package: &#39;car&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:mosaic&#39;:
## 
##     deltaMethod, logit</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     recode</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     some</code></pre>
<pre class="r"><code>vif(adm_mult_reg)</code></pre>
<pre><code>## actcmmid costt4_a 
## 1.446836 1.446836</code></pre>
<p>Fundamentally, the VIF is calculated with the following steps.</p>
<ol style="list-style-type: decimal">
<li>Fit a regression where one of the X attributes is the outcome and the remaining X attributes are predictors.</li>
<li>Calculate VIF: <span class="math inline">\(VIF = 1 / 1 - R^2\)</span> from step 1.</li>
<li>Repeate this for all X attributes.</li>
<li>Evaluate extent to which VIF is problematic. Rules of thumb include VIF statistics greater than 5 or 10.</li>
</ol>
<p>Interpretation wise, the square root of the VIF statistic can provide an indication of how inflated the standard error would be if the predictors are uncorrelated.</p>
<pre class="r"><code>act_lm &lt;- lm(actcmmid ~ costt4_a, data = college)
summary(act_lm)$r.square</code></pre>
<pre><code>## [1] 0.3088366</code></pre>
<pre class="r"><code>1 / (1 - .3088)</code></pre>
<pre><code>## [1] 1.446759</code></pre>
<pre class="r"><code>sqrt(1.446)</code></pre>
<pre><code>## [1] 1.202497</code></pre>
<div id="simulated-data-exploration" class="section level3">
<h3>Simulated data exploration</h3>
<p>Let’s use some simulated data to show the extent to which multicollinearity can be problematic, particularly for more highly correlated attributes.</p>
<p>First, let’s start with uncorrelated (on average) predictor attributes.</p>
<pre class="r"><code>library(simglm)

sim_args &lt;- list(formula = y ~ 1 + act + gpa + sat, 
                 fixed = list(act = list(var_type = &#39;continuous&#39;,
                                         mean = 20, 
                                         sd = 4),
                              gpa = list(var_type = &#39;continuous&#39;,
                                         mean = 2, 
                                         sd = .5),
                              sat = list(var_type = &#39;continuous&#39;,
                                         mean = 500, 
                                         sd = 100)),
                 correlate = list(fixed = data.frame(x = c(&#39;act&#39;, &#39;act&#39;, &#39;gpa&#39;), 
                                                     y = c(&#39;gpa&#39;, &#39;sat&#39;, &#39;sat&#39;), 
                                                     corr = c(0, 0, 0))),
                error = list(variance = 100),
                reg_weights = c(1, 1, 1, 1),
                 sample_size = 10000)

sim_data &lt;- simulate_fixed(data = NULL, sim_args) %&gt;%
   simulate_error(sim_args) %&gt;%
   correlate_variables(sim_args) %&gt;%
   generate_response(sim_args)

head(sim_data)</code></pre>
<pre><code>##   X.Intercept.  act_old  gpa_old  sat_old level1_id      error      act
## 1            1 26.48127 2.040890 319.9087         1 -14.902337 20.32712
## 2            1 26.66807 2.375853 563.8681         2   5.362910 23.00683
## 3            1 28.54474 2.083240 294.2014         3  17.484741 20.66592
## 4            1 15.65835 2.589041 436.0029         4  25.455466 24.71233
## 5            1 26.20330 2.358474 621.1055         5   1.956859 22.86779
## 6            1 17.28665 2.071681 647.2480         6  11.946032 20.57345
##         gpa      sat fixed_outcome random_effects        y
## 1 1.0995435 662.0317      684.4584              0 669.5561
## 2 2.3193407 666.7017      693.0278              0 698.3907
## 3 0.9710072 713.6185      736.2554              0 753.7402
## 4 1.6800143 391.4588      418.8512              0 444.3066
## 5 2.6055275 655.0824      681.5557              0 683.5126
## 6 2.7362400 432.1661      456.4758              0 468.4218</code></pre>
<pre class="r"><code>cor(sim_data[c(&#39;y&#39;, &#39;act&#39;, &#39;gpa&#39;, &#39;sat&#39;)])</code></pre>
<pre><code>##              y         act          gpa          sat
## y   1.00000000 0.040913035 0.0061986696 0.9942726899
## act 0.04091304 1.000000000 0.0060439799 0.0012967539
## gpa 0.00619867 0.006043980 1.0000000000 0.0003266099
## sat 0.99427269 0.001296754 0.0003266099 1.0000000000</code></pre>
<pre class="r"><code>sim_lm &lt;- lm(y ~ 1 + act + gpa + sat, data = sim_data)
summary(sim_lm)</code></pre>
<pre><code>## 
## Call:
## lm(formula = y ~ 1 + act + gpa + sat, data = sim_data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -41.107  -6.867   0.209   6.760  36.080 
## 
## Coefficients:
##              Estimate Std. Error  t value Pr(&gt;|t|)    
## (Intercept) 0.2194355  0.8178511    0.268    0.788    
## act         0.9979591  0.0249851   39.942  &lt; 2e-16 ***
## gpa         1.1466169  0.2016978    5.685 1.35e-08 ***
## sat         1.0010144  0.0009979 1003.087  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 10.02 on 9996 degrees of freedom
## Multiple R-squared:  0.9902, Adjusted R-squared:  0.9902 
## F-statistic: 3.36e+05 on 3 and 9996 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>vif(sim_lm)</code></pre>
<pre><code>##      act      gpa      sat 
## 1.000038 1.000037 1.000002</code></pre>
<p>Let’s now increase the correlation among the attributes.</p>
<pre class="r"><code>library(simglm)

sim_args &lt;- list(formula = y ~ 1 + act + gpa + sat, 
                 fixed = list(act = list(var_type = &#39;continuous&#39;,
                                         mean = 20, 
                                         sd = 4),
                              gpa = list(var_type = &#39;continuous&#39;,
                                         mean = 2, 
                                         sd = .5),
                              sat = list(var_type = &#39;continuous&#39;,
                                         mean = 500, 
                                         sd = 100)),
                 correlate = list(fixed = data.frame(x = c(&#39;act&#39;, &#39;act&#39;, &#39;gpa&#39;), 
                                                     y = c(&#39;gpa&#39;, &#39;sat&#39;, &#39;sat&#39;), 
                                                     corr = c(0.5, 0.5, 0.25))),
                error = list(variance = 100),
                reg_weights = c(1, 1, 1, 1),
                 sample_size = 10000)

sim_data &lt;- simulate_fixed(data = NULL, sim_args) %&gt;%
   simulate_error(sim_args) %&gt;%
   correlate_variables(sim_args) %&gt;%
   generate_response(sim_args)

head(sim_data)</code></pre>
<pre><code>##   X.Intercept.  act_old  gpa_old  sat_old level1_id      error      act
## 1            1 21.26112 1.252761 443.2062         1   3.868653 14.17835
## 2            1 19.75843 1.671193 545.7800         2 -12.312749 17.85641
## 3            1 11.91100 2.151368 470.0787         3 -15.151141 25.08944
## 4            1 21.43544 1.802930 611.1071         4  18.763528 17.94709
## 5            1 17.72532 2.134128 440.0137         5   4.509570 22.05115
## 6            1 16.42559 1.962536 592.9478         6  -1.827152 21.55536
##        gpa      sat fixed_outcome random_effects        y
## 1 1.876948 468.5760      485.6313              0 489.4999
## 2 1.665548 506.0850      526.6070              0 514.2942
## 3 2.448690 702.2039      730.7421              0 715.5909
## 4 1.389250 464.1415      484.4779              0 503.2414
## 5 2.388857 556.8483      582.2883              0 586.7978
## 6 1.694492 589.3654      613.6152              0 611.7881</code></pre>
<pre class="r"><code>cor(sim_data[c(&#39;y&#39;, &#39;act&#39;, &#39;gpa&#39;, &#39;sat&#39;)])</code></pre>
<pre><code>##             y       act       gpa       sat
## y   1.0000000 0.5266494 0.2570932 0.9945591
## act 0.5266494 1.0000000 0.4974442 0.4985519
## gpa 0.2570932 0.4974442 1.0000000 0.2381760
## sat 0.9945591 0.4985519 0.2381760 1.0000000</code></pre>
<pre class="r"><code>sim_lm2 &lt;- lm(y ~ 1 + act + gpa + sat, data = sim_data)
vif(sim_lm2)</code></pre>
<pre><code>##      act      gpa      sat 
## 1.668317 1.329044 1.330995</code></pre>
<pre class="r"><code>broom::tidy(sim_lm)</code></pre>
<pre><code>## # A tibble: 4 × 5
##   term        estimate std.error statistic     p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;
## 1 (Intercept)    0.219  0.818        0.268   7.88e-  1
## 2 act            0.998  0.0250      39.9   Inf.  e-324
## 3 gpa            1.15   0.202        5.68    1.35e-  8
## 4 sat            1.00   0.000998  1003.      0</code></pre>
<pre class="r"><code>broom::tidy(sim_lm2)</code></pre>
<pre><code>## # A tibble: 4 × 5
##   term        estimate std.error statistic   p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1 (Intercept)    1.16    0.615        1.89 5.88e-  2
## 2 act            0.959   0.0320      30.0  4.11e-189
## 3 gpa            1.29    0.234        5.52 3.40e-  8
## 4 sat            1.00    0.00116    863.   0</code></pre>
<pre class="r"><code>library(simglm)

sim_args &lt;- list(formula = y ~ 1 + act + gpa + sat, 
                 fixed = list(act = list(var_type = &#39;continuous&#39;,
                                         mean = 20, 
                                         sd = 4),
                              gpa = list(var_type = &#39;continuous&#39;,
                                         mean = 2, 
                                         sd = .5),
                              sat = list(var_type = &#39;continuous&#39;,
                                         mean = 500, 
                                         sd = 100)),
                 correlate = list(fixed = data.frame(x = c(&#39;act&#39;, &#39;act&#39;, &#39;gpa&#39;), 
                                                     y = c(&#39;gpa&#39;, &#39;sat&#39;, &#39;sat&#39;), 
                                                     corr = c(0.5, 0.9, 0.5))),
                error = list(variance = 100),
                reg_weights = c(1, 1, 1, 1),
                 sample_size = 10000)

sim_data &lt;- simulate_fixed(data = NULL, sim_args) %&gt;%
   simulate_error(sim_args) %&gt;%
   correlate_variables(sim_args) %&gt;%
   generate_response(sim_args)

head(sim_data)</code></pre>
<pre><code>##   X.Intercept.  act_old  gpa_old  sat_old level1_id      error      act
## 1            1 22.22053 1.717012 580.8290         1  14.717473 17.02755
## 2            1 22.76345 2.046200 519.7960         2  -8.830489 17.67599
## 3            1 23.88306 1.705211 269.3776         3 -32.714174 15.44298
## 4            1 23.14771 1.479477 500.3573         4   8.954454 15.35356
## 5            1 23.97499 1.838556 476.4292         5   9.220871 15.85566
## 6            1 17.73816 1.851759 577.6469         6  -8.176432 21.53169
##        gpa      sat fixed_outcome random_effects        y
## 1 1.480232 444.5228      464.0306              0 478.7481
## 2 1.748019 430.9080      451.3320              0 442.5015
## 3 2.710022 402.9595      422.1125              0 389.3983
## 4 1.738321 421.3728      439.4647              0 448.4191
## 5 1.832909 400.6454      419.3340              0 428.5549
## 6 1.790474 556.5651      580.8873              0 572.7108</code></pre>
<pre class="r"><code>cor(sim_data[c(&#39;y&#39;, &#39;act&#39;, &#39;gpa&#39;, &#39;sat&#39;)])</code></pre>
<pre><code>##             y       act       gpa       sat
## y   1.0000000 0.9058949 0.5082700 0.9952653
## act 0.9058949 1.0000000 0.5042671 0.9021442
## gpa 0.5082700 0.5042671 1.0000000 0.5055555
## sat 0.9952653 0.9021442 0.5055555 1.0000000</code></pre>
<pre class="r"><code>sim_lm3 &lt;- lm(y ~ 1 + act + gpa + sat, data = sim_data)
vif(sim_lm3)</code></pre>
<pre><code>##      act      gpa      sat 
## 5.463967 1.366230 5.473517</code></pre>
<pre class="r"><code>broom::tidy(sim_lm)</code></pre>
<pre><code>## # A tibble: 4 × 5
##   term        estimate std.error statistic     p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;
## 1 (Intercept)    0.219  0.818        0.268   7.88e-  1
## 2 act            0.998  0.0250      39.9   Inf.  e-324
## 3 gpa            1.15   0.202        5.68    1.35e-  8
## 4 sat            1.00   0.000998  1003.      0</code></pre>
<pre class="r"><code>broom::tidy(sim_lm2)</code></pre>
<pre><code>## # A tibble: 4 × 5
##   term        estimate std.error statistic   p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1 (Intercept)    1.16    0.615        1.89 5.88e-  2
## 2 act            0.959   0.0320      30.0  4.11e-189
## 3 gpa            1.29    0.234        5.52 3.40e-  8
## 4 sat            1.00    0.00116    863.   0</code></pre>
<pre class="r"><code>broom::tidy(sim_lm3)</code></pre>
<pre><code>## # A tibble: 4 × 5
##   term        estimate std.error statistic  p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 (Intercept)    1.60    0.542        2.95 3.16e- 3
## 2 act            1.09    0.0579      18.9  5.96e-78
## 3 gpa            0.865   0.233        3.72 2.03e- 4
## 4 sat            0.996   0.00233    428.   0</code></pre>
<pre class="r"><code>library(simglm)

sim_args &lt;- list(formula = y ~ 1 + act + gpa + sat, 
                 fixed = list(act = list(var_type = &#39;continuous&#39;,
                                         mean = 20, 
                                         sd = 4),
                              gpa = list(var_type = &#39;continuous&#39;,
                                         mean = 2, 
                                         sd = .5),
                              sat = list(var_type = &#39;continuous&#39;,
                                         mean = 500, 
                                         sd = 100)),
                 correlate = list(fixed = data.frame(x = c(&#39;act&#39;, &#39;act&#39;, &#39;gpa&#39;), 
                                                     y = c(&#39;gpa&#39;, &#39;sat&#39;, &#39;sat&#39;), 
                                                     corr = c(0.9, 0.98, 0.85))),
                error = list(variance = 100),
                reg_weights = c(1, 1, 1, 1),
                 sample_size = 10000)

sim_data &lt;- simulate_fixed(data = NULL, sim_args) %&gt;%
   simulate_error(sim_args) %&gt;%
   correlate_variables(sim_args) %&gt;%
   generate_response(sim_args)

head(sim_data)</code></pre>
<pre><code>##   X.Intercept.  act_old  gpa_old  sat_old level1_id       error      act
## 1            1 17.58088 2.300300 484.4704         1  11.0181274 22.84074
## 2            1 14.55817 1.858478 594.7029         2   1.8080004 25.14995
## 3            1 17.18873 1.423956 509.3717         3  -1.4169467 21.84507
## 4            1 25.71697 2.778663 602.6288         4  -0.8010988 15.67749
## 5            1 13.00762 1.584244 468.8132         5 -18.9261799 26.17956
## 6            1 21.14171 2.013742 631.0165         6  -0.4141820 18.95988
##        gpa      sat fixed_outcome random_effects        y
## 1 2.394579 560.4591      586.6944              0 597.7125
## 2 2.344760 636.0540      664.5487              0 666.3567
## 3 2.074372 570.3184      595.2379              0 593.8209
## 4 1.473183 357.0252      375.1758              0 374.3747
## 5 2.654372 674.8364      704.6703              0 685.7441
## 6 1.630657 471.4552      493.0457              0 492.6315</code></pre>
<pre class="r"><code>cor(sim_data[c(&#39;y&#39;, &#39;act&#39;, &#39;gpa&#39;, &#39;sat&#39;)])</code></pre>
<pre><code>##             y       act       gpa       sat
## y   1.0000000 0.9781163 0.8553408 0.9953159
## act 0.9781163 1.0000000 0.9026826 0.9805586
## gpa 0.8553408 0.9026826 1.0000000 0.8556478
## sat 0.9953159 0.9805586 0.8556478 1.0000000</code></pre>
<pre class="r"><code>sim_lm4 &lt;- lm(y ~ 1 + act + gpa + sat, data = sim_data)
vif(sim_lm4)</code></pre>
<pre><code>##       act       gpa       sat 
## 42.788116  6.150617 29.577466</code></pre>
<pre class="r"><code>broom::tidy(sim_lm)</code></pre>
<pre><code>## # A tibble: 4 × 5
##   term        estimate std.error statistic     p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;
## 1 (Intercept)    0.219  0.818        0.268   7.88e-  1
## 2 act            0.998  0.0250      39.9   Inf.  e-324
## 3 gpa            1.15   0.202        5.68    1.35e-  8
## 4 sat            1.00   0.000998  1003.      0</code></pre>
<pre class="r"><code>broom::tidy(sim_lm2)</code></pre>
<pre><code>## # A tibble: 4 × 5
##   term        estimate std.error statistic   p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1 (Intercept)    1.16    0.615        1.89 5.88e-  2
## 2 act            0.959   0.0320      30.0  4.11e-189
## 3 gpa            1.29    0.234        5.52 3.40e-  8
## 4 sat            1.00    0.00116    863.   0</code></pre>
<pre class="r"><code>broom::tidy(sim_lm3)</code></pre>
<pre><code>## # A tibble: 4 × 5
##   term        estimate std.error statistic  p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 (Intercept)    1.60    0.542        2.95 3.16e- 3
## 2 act            1.09    0.0579      18.9  5.96e-78
## 3 gpa            0.865   0.233        3.72 2.03e- 4
## 4 sat            0.996   0.00233    428.   0</code></pre>
<pre class="r"><code>broom::tidy(sim_lm4)</code></pre>
<pre><code>## # A tibble: 4 × 5
##   term        estimate std.error statistic  p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 (Intercept)    1.19    0.529       2.25  2.47e- 2
## 2 act            1.43    0.165       8.65  5.74e-18
## 3 gpa            0.186   0.497       0.373 7.09e- 1
## 4 sat            0.986   0.00547   180.    0</code></pre>
</div>
</div>
</div>

          </div>

          



          
          
          <div class="article-widget">
            
<div class="post-nav">
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Previous</div>
    <a href="/lectures/10-model-comparison-class/" rel="next">Model Comparison</a>
  </div>
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Next</div>
    <a href="/lectures/11-multicollinearity-class/" rel="prev">Multicollinearity</a>
  </div>
  
</div>

          </div>
          
        </div>

        <div class="body-footer">
          <p>Last updated on Oct 13, 2021</p>

          



          




          


        </div>

      </article>

      <footer class="site-footer">
  

  <p class="powered-by">
    
  </p>

  
  






  <p class="powered-by">
    
    
    
    Published with
    <a href="https://wowchemy.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Wowchemy</a>  —
    the free, <a href="https://github.com/wowchemy/wowchemy-hugo-modules" target="_blank" rel="noopener">
    open source</a> website builder that empowers creators.
    
  </p>
</footer>


    </main>
  </div>
</div>

  </div>

  <div class="page-footer">
    
    
  </div>

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

      
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      

      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/instant.page/5.1.0/instantpage.min.js" integrity="sha512-1+qUtKoh9XZW7j+6LhRMAyOrgSQKenQ4mluTR+cvxXjP1Z54RxZuzstR/H9kgPXQsVB8IW7DMDFUJpzLjvhGSQ==" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js" integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/r.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.js" integrity="sha512-SeiQaaDh73yrb56sTW/RgVdi/mMqNeM2oBwubFHagc5BkixSpP1fvqF47mKzPGWYSSy4RwbBunrJBQ4Co8fRWA==" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'event' : "Events",
        'slides' : "Slides"
        };
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.2/anchor.min.js" integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin="anonymous"></script>
    <script>
      anchors.add();
    </script>
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    
    

    
    

    
    

    
    
    
    
    
    
    
    
    
    
      
      
    
    
    <script src="/js/wowchemy.min.d4185df71ecf716f1c4e7ef5f3d4e2b8.js"></script>

    






</body>
</html>
