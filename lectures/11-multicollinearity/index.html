<!DOCTYPE html><html lang="en-us" >

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  
  
  <meta name="generator" content="Wowchemy 5.0.0-beta.1 for Hugo">
  

  

  
  

  
  
  
  
  
    
    
    
  
  

  

  
  
  
    
  
  <meta name="description" content="Multicollinearity">

  
  <link rel="alternate" hreflang="en-us" href="https://psqf6243.brandonlebeau.org/lectures/11-multicollinearity/">

  







  




  
  
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  

  
  
  
  <meta name="theme-color" content="#1565c0">
  

  
  
  
  <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha256-FMvZuGapsJLjouA6k7Eo2lusoAX9i0ShlWFG6qt7SLc=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous" media="print" onload="this.media='all'">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github.min.css" crossorigin="anonymous" title="hl-light" media="print" onload="this.media='all'">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" media="print" onload="this.media='all'" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.css" integrity="sha512-1xoFisiGdy9nvho8EgXuXvnpR5GAMSjFwp40gSRE3NwdUdIMIKuPa7bqoUhLD0O/5tPNhteAsE5XyyMi5reQVA==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.2.2/lazysizes.min.js" integrity="sha512-TmDwFLhg3UA4ZG0Eb4MIyT1O1Mb+Oww5kFG0uHqXsdbyZz9DcvYQhKpGgNkamAI6h2lGGZq2X8ftOJvF/XjTUg==" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    

  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.3aad675291f323c3cd47ae187f0bf0d6.css">

  




  

  


  
  

  

  
  <link rel="manifest" href="/index.webmanifest">
  

  <link rel="icon" type="image/png" href="/images/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_32x32_fill_lanczos_center_3.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_192x192_fill_lanczos_center_3.png">

  <link rel="canonical" href="https://psqf6243.brandonlebeau.org/lectures/11-multicollinearity/">

  
  
  
  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="og:site_name" content="PSQF 6243">
  <meta property="og:url" content="https://psqf6243.brandonlebeau.org/lectures/11-multicollinearity/">
  <meta property="og:title" content="Multicollinearity | PSQF 6243">
  <meta property="og:description" content="Multicollinearity"><meta property="og:image" content="https://psqf6243.brandonlebeau.org/media/blue-balloon.jpg">
  <meta property="twitter:image" content="https://psqf6243.brandonlebeau.org/media/blue-balloon.jpg"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2021-10-13T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2021-10-13T00:00:00&#43;00:00">
  

  



  


  


  





  <title>Multicollinearity | PSQF 6243</title>

</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper  ">

  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.7de282f2047be3c570af3a58788341e7.js"></script>

  

<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="Search...">
        
      </div>

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header">
    












<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">PSQF 6243</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">PSQF 6243</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#logistics"><span>Logistics</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/syllabus/"><span>Syllabus</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/schedule/"><span>Schedule</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/content/"><span>Content</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link  active" href="/lectures/"><span>Lecture Notes</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/assignments/"><span>Assignments</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/code/"><span>Software Resources</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#people"><span>People</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

      
      
        
      

      
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true" aria-label="Display preferences">
          <i class="fas fa-moon" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      

    </ul>

  </div>
</nav>


  </div>

  <div class="page-body">
    





<div class="container-fluid docs">
  <div class="row flex-xl-nowrap">
    <div class="col-12 col-md-3 col-xl-2 docs-sidebar">
      <form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-3" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <span><i class="fas fa-bars"></i></span>
  </button>

  
  <button class="form-control sidebar-search js-search">
    <i class="fas fa-search pr-2"></i>
    <span class="sidebar-search-text">Search...</span>
    <span class="sidebar-search-shortcut">/</span>
  </button>
  
</form>

<nav class="collapse docs-links" id="docs-nav">
  
  
  
  
  
  

  
  
    

    
      

      
      
      


  
    
    
    
    
      
    
    

    
      <ul class="nav docs-sidenav">
        <li class=""><a href="/lectures/">Lecture Notes</a></li>
    
      


  <li class=""><a href="/lectures/review/">Review</a></li>



  <li class=""><a href="/lectures/review-class/">Review - class</a></li>



  <li class=""><a href="/lectures/intro-regression/">Intro to Linear Regression</a></li>



  <li class=""><a href="/lectures/linear-regression-class/">Intro to Linear Regression - class</a></li>



  <li class=""><a href="/lectures/regression-estimates/">Linear Regression Estimates</a></li>



  <li class=""><a href="/lectures/regression-estimates-class/">Linear Regression Estimates - class</a></li>



  <li class=""><a href="/lectures/least-squares-simulation/">Least Square Simulation</a></li>



  <li class=""><a href="/lectures/regression-inference-p1/">Regression Inference - Part 1</a></li>



  <li class=""><a href="/lectures/05-regression-inference/">Regression Inference - Part 1</a></li>



  <li class=""><a href="/lectures/05a-regression-inference/">Regression Inference - Part 2</a></li>



  <li class=""><a href="/lectures/05a-regression-inference-class/">Regression Inference - Part 2 - Class</a></li>



  <li class=""><a href="/lectures/06-t-vs-norm/">t vs Normal</a></li>



  <li class=""><a href="/lectures/07-regression-assumptions/">Regression Assumptions</a></li>



  <li class=""><a href="/lectures/07a-regression-assumptions/">Regression Assumptions - New Package</a></li>



  <li class=""><a href="/lectures/08-bootstrap/">Regression Bootstrap</a></li>



  <li class=""><a href="/lectures/08-bootstrap-class/">Regression Bootstrap - Class</a></li>



  <li class=""><a href="/lectures/09-multiple-regression-p1/">Multiple Regression - Part 1</a></li>



  <li class=""><a href="/lectures/09-multiple-regression-p1-class/">Multiple Regression - Part 1</a></li>



  <li class=""><a href="/lectures/10-model-comparison/">Model Comparison</a></li>



  <li class=""><a href="/lectures/10-model-comparison-class/">Model Comparison</a></li>



  <li class="active"><a href="/lectures/11-multicollinearity/">Multicollinearity</a></li>



  <li class=""><a href="/lectures/11-multicollinearity-class/">Multicollinearity</a></li>



  <li class=""><a href="/lectures/12-regression-categorical/">Regression Categorical Predictors</a></li>



  <li class=""><a href="/lectures/12-regression-categorical-class/">Regression Categorical Predictors</a></li>



  <li class=""><a href="/lectures/13-regression-categorical-p2/">Regression Categorical Predictors - p2</a></li>



  <li class=""><a href="/lectures/13-regression-categorical-p2-class/">Regression Categorical Predictors - p2</a></li>



  <li class=""><a href="/lectures/14-pairwise/">Pairwise Contrasts</a></li>



  <li class=""><a href="/lectures/14-pairwise-class/">Pairwise Contrasts</a></li>



  <li class=""><a href="/lectures/15-multiple-categorical/">Multiple Categorical Predictors</a></li>



  <li class=""><a href="/lectures/16-ancova/">Analysis of Covariance</a></li>



  <li class=""><a href="/lectures/17-categorical-interactions/">Categorical Interactions</a></li>

      
    

    
      </ul>
    

  
</nav>

    </div>

    
    
    <div class="d-none d-xl-block col-xl-2 docs-toc">
      <ul class="nav toc-top">
        <li><a href="#" id="back_to_top" class="docs-toc-title">Contents</a></li>
      </ul>

      

      
    </div>
    

    <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role="main">

      <article class="article">

        <div class="docs-article-container">
          

          <h1>Multicollinearity</h1>

          <div class="article-style">
            
<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>

<div id="TOC">

</div>

<div id="multicollinearity" class="section level1">
<h1>Multicollinearity</h1>
<p>Multicollinearity is an assumption of regression that explores whether the predictor attributes (X) are correlated. Linear regression assumes that the predictor attributes are uncorrelated, but in practice this assumption is never met. What impacts does multicollinearity have on the linear regression? The short answer is that the regression parameters (the <span class="math inline">\(\beta\)</span> terms) will be more or less unbiased, however, the same cannot be said for the standard errors.</p>
<p>Let’s first use some real data to explore this, then we’ll use simulated data to show the impact correlated predictor attributes have on the linear regression estiamtes.</p>
<pre class="r"><code>library(tidyverse)</code></pre>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──</code></pre>
<pre><code>## ✓ ggplot2 3.3.5     ✓ purrr   0.3.4
## ✓ tibble  3.1.5     ✓ dplyr   1.0.7
## ✓ tidyr   1.1.4     ✓ stringr 1.4.0
## ✓ readr   2.0.2     ✓ forcats 0.5.1</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>library(ggformula)</code></pre>
<pre><code>## Loading required package: ggstance</code></pre>
<pre><code>## 
## Attaching package: &#39;ggstance&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:ggplot2&#39;:
## 
##     geom_errorbarh, GeomErrorbarh</code></pre>
<pre><code>## Loading required package: scales</code></pre>
<pre><code>## 
## Attaching package: &#39;scales&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     discard</code></pre>
<pre><code>## The following object is masked from &#39;package:readr&#39;:
## 
##     col_factor</code></pre>
<pre><code>## Loading required package: ggridges</code></pre>
<pre><code>## 
## New to ggformula?  Try the tutorials: 
##  learnr::run_tutorial(&quot;introduction&quot;, package = &quot;ggformula&quot;)
##  learnr::run_tutorial(&quot;refining&quot;, package = &quot;ggformula&quot;)</code></pre>
<pre class="r"><code>theme_set(theme_bw(base_size = 18))

college &lt;- read_csv(&quot;https://raw.githubusercontent.com/lebebr01/statthink/main/data-raw/College-scorecard-4143.csv&quot;) %&gt;%
  mutate(act_mean = actcmmid - mean(actcmmid, na.rm = TRUE),
         cost_mean = costt4_a - mean(costt4_a, na.rm = TRUE)) %&gt;%
  drop_na(act_mean, cost_mean)</code></pre>
<pre><code>## Rows: 7058 Columns: 16</code></pre>
<pre><code>## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr  (6): instnm, city, stabbr, preddeg, region, locale
## dbl (10): adm_rate, actcmmid, ugds, costt4_a, costt4_p, tuitionfee_in, tuiti...</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<pre class="r"><code>adm_mult_reg &lt;- lm(adm_rate ~ actcmmid + costt4_a, data = college)

summary(adm_mult_reg)</code></pre>
<pre><code>## 
## Call:
## lm(formula = adm_rate ~ actcmmid + costt4_a, data = college)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.65484 -0.12230  0.02291  0.13863  0.37054 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  1.135e+00  3.326e-02  34.130  &lt; 2e-16 ***
## actcmmid    -1.669e-02  1.650e-03 -10.114  &lt; 2e-16 ***
## costt4_a    -2.304e-06  4.047e-07  -5.693 1.55e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1813 on 1278 degrees of freedom
## Multiple R-squared:  0.1836, Adjusted R-squared:  0.1824 
## F-statistic: 143.8 on 2 and 1278 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>library(mosaic)</code></pre>
<pre><code>## Registered S3 method overwritten by &#39;mosaic&#39;:
##   method                           from   
##   fortify.SpatialPolygonsDataFrame ggplot2</code></pre>
<pre><code>## 
## The &#39;mosaic&#39; package masks several functions from core packages in order to add 
## additional features.  The original behavior of these functions should not be affected by this.</code></pre>
<pre><code>## 
## Attaching package: &#39;mosaic&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:Matrix&#39;:
## 
##     mean</code></pre>
<pre><code>## The following object is masked from &#39;package:scales&#39;:
## 
##     rescale</code></pre>
<pre><code>## The following objects are masked from &#39;package:dplyr&#39;:
## 
##     count, do, tally</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     cross</code></pre>
<pre><code>## The following object is masked from &#39;package:ggplot2&#39;:
## 
##     stat</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     binom.test, cor, cor.test, cov, fivenum, IQR, median, prop.test,
##     quantile, sd, t.test, var</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     max, mean, min, prod, range, sample, sum</code></pre>
<pre class="r"><code>cor(actcmmid ~ costt4_a, data = college)</code></pre>
<pre><code>## [1] 0.5557307</code></pre>
<div id="variance-inflation-factor" class="section level2">
<h2>Variance Inflation Factor</h2>
<p>The variance inflation factor (VIF) is a commonly used statistic to aid in diagnosing multicollinearity. It attempts to estimate how much the variance of the estimated regression equation is inflated due to correlated predictor attributes.</p>
<p>First, this can be calculated from the car package, using the function <code>vif()</code>.</p>
<pre class="r"><code>library(car)</code></pre>
<pre><code>## Loading required package: carData</code></pre>
<pre><code>## 
## Attaching package: &#39;car&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:mosaic&#39;:
## 
##     deltaMethod, logit</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     recode</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     some</code></pre>
<pre class="r"><code>vif(adm_mult_reg)</code></pre>
<pre><code>## actcmmid costt4_a 
## 1.446836 1.446836</code></pre>
<p>Fundamentally, the VIF is calculated with the following steps.</p>
<ol style="list-style-type: decimal">
<li>Fit a regression where one of the X attributes is the outcome and the remaining X attributes are predictors.</li>
<li>Calculate VIF: <span class="math inline">\(VIF = 1 / 1 - R^2\)</span> from step 1.</li>
<li>Repeate this for all X attributes.</li>
<li>Evaluate extent to which VIF is problematic. Rules of thumb include VIF statistics greater than 5 or 10.</li>
</ol>
<p>Interpretation wise, the square root of the VIF statistic can provide an indication of how inflated the standard error would be if the predictors are uncorrelated.</p>
<pre class="r"><code>act_lm &lt;- lm(actcmmid ~ costt4_a, data = college)
summary(act_lm)$r.square</code></pre>
<pre><code>## [1] 0.3088366</code></pre>
<pre class="r"><code>1 / (1 - .3088)</code></pre>
<pre><code>## [1] 1.446759</code></pre>
<pre class="r"><code>sqrt(1.446)</code></pre>
<pre><code>## [1] 1.202497</code></pre>
<div id="simulated-data-exploration" class="section level3">
<h3>Simulated data exploration</h3>
<p>Let’s use some simulated data to show the extent to which multicollinearity can be problematic, particularly for more highly correlated attributes.</p>
<p>First, let’s start with uncorrelated (on average) predictor attributes.</p>
<pre class="r"><code>library(simglm)

sim_args &lt;- list(formula = y ~ 1 + act + gpa + sat, 
                 fixed = list(act = list(var_type = &#39;continuous&#39;,
                                         mean = 20, 
                                         sd = 4),
                              gpa = list(var_type = &#39;continuous&#39;,
                                         mean = 2, 
                                         sd = .5),
                              sat = list(var_type = &#39;continuous&#39;,
                                         mean = 500, 
                                         sd = 100)),
                 correlate = list(fixed = data.frame(x = c(&#39;act&#39;, &#39;act&#39;, &#39;gpa&#39;), 
                                                     y = c(&#39;gpa&#39;, &#39;sat&#39;, &#39;sat&#39;), 
                                                     corr = c(0, 0, 0))),
                error = list(variance = 100),
                reg_weights = c(1, 1, 1, 1),
                 sample_size = 10000)

sim_data &lt;- simulate_fixed(data = NULL, sim_args) %&gt;%
   simulate_error(sim_args) %&gt;%
   correlate_variables(sim_args) %&gt;%
   generate_response(sim_args)

head(sim_data)</code></pre>
<pre><code>##   X.Intercept.  act_old  gpa_old  sat_old level1_id      error      act
## 1            1 23.29475 2.114935 413.8465         1   2.021092 20.91948
## 2            1 23.29512 2.418542 515.7543         2 -11.843219 23.34834
## 3            1 20.38279 2.522819 525.8997         3   9.113430 24.18255
## 4            1 16.82378 1.824946 328.0176         4   7.925915 18.59957
## 5            1 18.44567 1.940021 350.2714         5  -6.750253 19.52016
## 6            1 21.99329 1.390459 342.1870         6 -25.435892 15.12368
##        gpa      sat fixed_outcome random_effects        y
## 1 1.569233 582.3688      605.8575              0 607.8786
## 2 2.078771 582.3780      608.8051              0 596.9619
## 3 2.129498 509.5698      536.8819              0 545.9953
## 4 1.140088 420.5944      441.3341              0 449.2600
## 5 1.251357 461.1417      482.9133              0 476.1630
## 6 1.210935 549.8321      567.1667              0 541.7308</code></pre>
<pre class="r"><code>cor(sim_data[c(&#39;y&#39;, &#39;act&#39;, &#39;gpa&#39;, &#39;sat&#39;)])</code></pre>
<pre><code>##                y          act          gpa          sat
## y    1.000000000  0.038611157 -0.001183156  0.994121831
## act  0.038611157  1.000000000 -0.011901500 -0.001161752
## gpa -0.001183156 -0.011901500  1.000000000 -0.005267216
## sat  0.994121831 -0.001161752 -0.005267216  1.000000000</code></pre>
<pre class="r"><code>sim_lm &lt;- lm(y ~ 1 + act + gpa + sat, data = sim_data)
summary(sim_lm)</code></pre>
<pre><code>## 
## Call:
## lm(formula = y ~ 1 + act + gpa + sat, data = sim_data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -38.113  -6.840   0.005   6.729  40.387 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 1.359170   0.840208   1.618    0.106    
## act         1.012175   0.025578  39.573  &lt; 2e-16 ***
## gpa         0.933191   0.207413   4.499  6.9e-06 ***
## sat         0.999412   0.001011 988.070  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 10.14 on 9996 degrees of freedom
## Multiple R-squared:  0.9899, Adjusted R-squared:  0.9899 
## F-statistic: 3.259e+05 on 3 and 9996 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>vif(sim_lm)</code></pre>
<pre><code>##      act      gpa      sat 
## 1.000143 1.000170 1.000029</code></pre>
<p>Let’s now increase the correlation among the attributes.</p>
<pre class="r"><code>library(simglm)

sim_args &lt;- list(formula = y ~ 1 + act + gpa + sat, 
                 fixed = list(act = list(var_type = &#39;continuous&#39;,
                                         mean = 20, 
                                         sd = 4),
                              gpa = list(var_type = &#39;continuous&#39;,
                                         mean = 2, 
                                         sd = .5),
                              sat = list(var_type = &#39;continuous&#39;,
                                         mean = 500, 
                                         sd = 100)),
                 correlate = list(fixed = data.frame(x = c(&#39;act&#39;, &#39;act&#39;, &#39;gpa&#39;), 
                                                     y = c(&#39;gpa&#39;, &#39;sat&#39;, &#39;sat&#39;), 
                                                     corr = c(0.5, 0.5, 0.25))),
                error = list(variance = 100),
                reg_weights = c(1, 1, 1, 1),
                 sample_size = 10000)

sim_data &lt;- simulate_fixed(data = NULL, sim_args) %&gt;%
   simulate_error(sim_args) %&gt;%
   correlate_variables(sim_args) %&gt;%
   generate_response(sim_args)

head(sim_data)</code></pre>
<pre><code>##   X.Intercept.  act_old   gpa_old  sat_old level1_id      error       act
## 1            1 23.19123 1.9778355 618.0640         1 -12.744127 18.281297
## 2            1 17.68920 1.5349688 453.1349         2 -12.259184 17.923525
## 3            1 19.85267 2.0870180 520.0450         3  11.201839 20.681862
## 4            1 18.91341 1.3367326 444.7078         4  -7.704769 15.935551
## 5            1 24.22358 0.4217496 368.1167         5 -10.279486  6.919853
## 6            1 18.38209 2.3880198 649.1697         6   4.362101 23.537892
##        gpa      sat fixed_outcome random_effects        y
## 1 1.381211 420.2224      440.8849              0 428.1408
## 2 2.069964 557.8347      578.8282              0 566.5690
## 3 1.956417 503.6713      527.3095              0 538.5114
## 4 1.980847 527.2571      546.1735              0 538.4688
## 5 1.742738 394.6303      404.2929              0 394.0134
## 6 1.577872 540.3938      566.5096              0 570.8717</code></pre>
<pre class="r"><code>cor(sim_data[c(&#39;y&#39;, &#39;act&#39;, &#39;gpa&#39;, &#39;sat&#39;)])</code></pre>
<pre><code>##             y       act       gpa       sat
## y   1.0000000 0.5260210 0.2773632 0.9946894
## act 0.5260210 1.0000000 0.5000795 0.4992494
## gpa 0.2773632 0.5000795 1.0000000 0.2602186
## sat 0.9946894 0.4992494 0.2602186 1.0000000</code></pre>
<pre class="r"><code>sim_lm2 &lt;- lm(y ~ 1 + act + gpa + sat, data = sim_data)
vif(sim_lm2)</code></pre>
<pre><code>##      act      gpa      sat 
## 1.656245 1.333738 1.332265</code></pre>
<pre class="r"><code>broom::tidy(sim_lm)</code></pre>
<pre><code>## # A tibble: 4 × 5
##   term        estimate std.error statistic   p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1 (Intercept)    1.36    0.840        1.62 1.06e-  1
## 2 act            1.01    0.0256      39.6  2.69e-318
## 3 gpa            0.933   0.207        4.50 6.90e-  6
## 4 sat            0.999   0.00101    988.   0</code></pre>
<pre class="r"><code>broom::tidy(sim_lm2)</code></pre>
<pre><code>## # A tibble: 4 × 5
##   term        estimate std.error statistic   p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1 (Intercept)    1.88    0.611        3.08 2.07e-  3
## 2 act            0.949   0.0324      29.3  1.29e-180
## 3 gpa            1.11    0.233        4.78 1.76e-  6
## 4 sat            1.00    0.00115    870.   0</code></pre>
<pre class="r"><code>library(simglm)

sim_args &lt;- list(formula = y ~ 1 + act + gpa + sat, 
                 fixed = list(act = list(var_type = &#39;continuous&#39;,
                                         mean = 20, 
                                         sd = 4),
                              gpa = list(var_type = &#39;continuous&#39;,
                                         mean = 2, 
                                         sd = .5),
                              sat = list(var_type = &#39;continuous&#39;,
                                         mean = 500, 
                                         sd = 100)),
                 correlate = list(fixed = data.frame(x = c(&#39;act&#39;, &#39;act&#39;, &#39;gpa&#39;), 
                                                     y = c(&#39;gpa&#39;, &#39;sat&#39;, &#39;sat&#39;), 
                                                     corr = c(0.5, 0.9, 0.5))),
                error = list(variance = 100),
                reg_weights = c(1, 1, 1, 1),
                 sample_size = 10000)

sim_data &lt;- simulate_fixed(data = NULL, sim_args) %&gt;%
   simulate_error(sim_args) %&gt;%
   correlate_variables(sim_args) %&gt;%
   generate_response(sim_args)

head(sim_data)</code></pre>
<pre><code>##   X.Intercept.  act_old  gpa_old  sat_old level1_id      error      act
## 1            1 23.44920 2.422920 661.0600         1  0.8753902 18.39175
## 2            1 18.99572 1.944144 469.6491         2  1.2878507 20.70505
## 3            1 20.72107 1.424236 379.4000         3  1.4345819 17.32766
## 4            1 12.58496 2.026681 450.6616         4 -3.5433526 26.76107
## 5            1 20.68428 2.037381 551.3067         5 -9.3529902 19.52184
## 6            1 19.76456 2.003312 489.4311         6 -3.2976748 20.22191
##        gpa      sat fixed_outcome random_effects        y
## 1 1.145445 413.7177      434.2549              0 435.1303
## 2 2.186086 525.1138      549.0049              0 550.2928
## 3 2.401812 482.0449      502.7744              0 504.2090
## 4 2.678271 685.3722      715.8116              0 712.2682
## 5 1.741832 482.8886      505.1523              0 495.7993
## 6 2.060428 505.8855      529.1678              0 525.8701</code></pre>
<pre class="r"><code>cor(sim_data[c(&#39;y&#39;, &#39;act&#39;, &#39;gpa&#39;, &#39;sat&#39;)])</code></pre>
<pre><code>##             y       act       gpa       sat
## y   1.0000000 0.9020841 0.4936929 0.9952725
## act 0.9020841 1.0000000 0.4915828 0.8988139
## gpa 0.4936929 0.4915828 1.0000000 0.4912870
## sat 0.9952725 0.8988139 0.4912870 1.0000000</code></pre>
<pre class="r"><code>sim_lm3 &lt;- lm(y ~ 1 + act + gpa + sat, data = sim_data)
vif(sim_lm3)</code></pre>
<pre><code>##      act      gpa      sat 
## 5.295566 1.341163 5.293536</code></pre>
<pre class="r"><code>broom::tidy(sim_lm)</code></pre>
<pre><code>## # A tibble: 4 × 5
##   term        estimate std.error statistic   p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1 (Intercept)    1.36    0.840        1.62 1.06e-  1
## 2 act            1.01    0.0256      39.6  2.69e-318
## 3 gpa            0.933   0.207        4.50 6.90e-  6
## 4 sat            0.999   0.00101    988.   0</code></pre>
<pre class="r"><code>broom::tidy(sim_lm2)</code></pre>
<pre><code>## # A tibble: 4 × 5
##   term        estimate std.error statistic   p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1 (Intercept)    1.88    0.611        3.08 2.07e-  3
## 2 act            0.949   0.0324      29.3  1.29e-180
## 3 gpa            1.11    0.233        4.78 1.76e-  6
## 4 sat            1.00    0.00115    870.   0</code></pre>
<pre class="r"><code>broom::tidy(sim_lm3)</code></pre>
<pre><code>## # A tibble: 4 × 5
##   term        estimate std.error statistic  p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 (Intercept)    0.578   0.546        1.06 2.90e- 1
## 2 act            0.987   0.0569      17.4  1.64e-66
## 3 gpa            0.778   0.232        3.36 7.86e- 4
## 4 sat            1.00    0.00230    436.   0</code></pre>
<pre class="r"><code>library(simglm)

sim_args &lt;- list(formula = y ~ 1 + act + gpa + sat, 
                 fixed = list(act = list(var_type = &#39;continuous&#39;,
                                         mean = 20, 
                                         sd = 4),
                              gpa = list(var_type = &#39;continuous&#39;,
                                         mean = 2, 
                                         sd = .5),
                              sat = list(var_type = &#39;continuous&#39;,
                                         mean = 500, 
                                         sd = 100)),
                 correlate = list(fixed = data.frame(x = c(&#39;act&#39;, &#39;act&#39;, &#39;gpa&#39;), 
                                                     y = c(&#39;gpa&#39;, &#39;sat&#39;, &#39;sat&#39;), 
                                                     corr = c(0.9, 0.98, 0.85))),
                error = list(variance = 100),
                reg_weights = c(1, 1, 1, 1),
                 sample_size = 10000)

sim_data &lt;- simulate_fixed(data = NULL, sim_args) %&gt;%
   simulate_error(sim_args) %&gt;%
   correlate_variables(sim_args) %&gt;%
   generate_response(sim_args)

head(sim_data)</code></pre>
<pre><code>##   X.Intercept.  act_old  gpa_old  sat_old level1_id      error      act
## 1            1 19.75597 2.240483 364.1152         1  -4.984026 20.56169
## 2            1 20.56974 1.374514 400.9198         2 -18.778312 18.40579
## 3            1 19.04044 2.039077 542.0656         3  16.046671 21.02075
## 4            1 18.71553 1.972200 488.3391         4  -1.927611 21.20967
## 5            1 22.39880 2.632699 363.0852         5   3.790132 18.59359
## 6            1 18.84584 1.823527 494.7004         6   4.245650 20.84876
##        gpa      sat fixed_outcome random_effects        y
## 1 2.374383 506.0865      530.0226              0 525.0386
## 2 1.906766 485.7973      507.1098              0 488.3315
## 3 2.034747 523.9860      548.0415              0 564.0882
## 4 2.149051 532.1137      556.4724              0 554.5448
## 5 2.235981 439.9910      461.8206              0 465.6107
## 6 2.069685 528.8652      552.7836              0 557.0293</code></pre>
<pre class="r"><code>cor(sim_data[c(&#39;y&#39;, &#39;act&#39;, &#39;gpa&#39;, &#39;sat&#39;)])</code></pre>
<pre><code>##             y       act       gpa       sat
## y   1.0000000 0.9777741 0.8491325 0.9952783
## act 0.9777741 1.0000000 0.8986654 0.9802708
## gpa 0.8491325 0.8986654 1.0000000 0.8489338
## sat 0.9952783 0.9802708 0.8489338 1.0000000</code></pre>
<pre class="r"><code>sim_lm4 &lt;- lm(y ~ 1 + act + gpa + sat, data = sim_data)
vif(sim_lm4)</code></pre>
<pre><code>##       act       gpa       sat 
## 43.018605  6.017294 29.632865</code></pre>
<pre class="r"><code>broom::tidy(sim_lm)</code></pre>
<pre><code>## # A tibble: 4 × 5
##   term        estimate std.error statistic   p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1 (Intercept)    1.36    0.840        1.62 1.06e-  1
## 2 act            1.01    0.0256      39.6  2.69e-318
## 3 gpa            0.933   0.207        4.50 6.90e-  6
## 4 sat            0.999   0.00101    988.   0</code></pre>
<pre class="r"><code>broom::tidy(sim_lm2)</code></pre>
<pre><code>## # A tibble: 4 × 5
##   term        estimate std.error statistic   p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1 (Intercept)    1.88    0.611        3.08 2.07e-  3
## 2 act            0.949   0.0324      29.3  1.29e-180
## 3 gpa            1.11    0.233        4.78 1.76e-  6
## 4 sat            1.00    0.00115    870.   0</code></pre>
<pre class="r"><code>broom::tidy(sim_lm3)</code></pre>
<pre><code>## # A tibble: 4 × 5
##   term        estimate std.error statistic  p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 (Intercept)    0.578   0.546        1.06 2.90e- 1
## 2 act            0.987   0.0569      17.4  1.64e-66
## 3 gpa            0.778   0.232        3.36 7.86e- 4
## 4 sat            1.00    0.00230    436.   0</code></pre>
<pre class="r"><code>broom::tidy(sim_lm4)</code></pre>
<pre><code>## # A tibble: 4 × 5
##   term        estimate std.error statistic  p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 (Intercept)    0.888   0.528        1.68 9.29e- 2
## 2 act            1.27    0.166        7.69 1.66e-14
## 3 gpa            0.727   0.493        1.47 1.41e- 1
## 4 sat            0.990   0.00551    180.   0</code></pre>
</div>
</div>
</div>

          </div>

          



          
          
          <div class="article-widget">
            
<div class="post-nav">
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Previous</div>
    <a href="/lectures/10-model-comparison-class/" rel="next">Model Comparison</a>
  </div>
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Next</div>
    <a href="/lectures/11-multicollinearity-class/" rel="prev">Multicollinearity</a>
  </div>
  
</div>

          </div>
          
        </div>

        <div class="body-footer">
          <p>Last updated on Oct 13, 2021</p>

          



          




          


        </div>

      </article>

      <footer class="site-footer">
  

  <p class="powered-by">
    
  </p>

  
  






  <p class="powered-by">
    
    
    
    Published with
    <a href="https://wowchemy.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Wowchemy</a>  —
    the free, <a href="https://github.com/wowchemy/wowchemy-hugo-modules" target="_blank" rel="noopener">
    open source</a> website builder that empowers creators.
    
  </p>
</footer>


    </main>
  </div>
</div>

  </div>

  <div class="page-footer">
    
    
  </div>

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

      
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      

      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/instant.page/5.1.0/instantpage.min.js" integrity="sha512-1+qUtKoh9XZW7j+6LhRMAyOrgSQKenQ4mluTR+cvxXjP1Z54RxZuzstR/H9kgPXQsVB8IW7DMDFUJpzLjvhGSQ==" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js" integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/r.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.js" integrity="sha512-SeiQaaDh73yrb56sTW/RgVdi/mMqNeM2oBwubFHagc5BkixSpP1fvqF47mKzPGWYSSy4RwbBunrJBQ4Co8fRWA==" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'event' : "Events",
        'slides' : "Slides"
        };
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.2/anchor.min.js" integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin="anonymous"></script>
    <script>
      anchors.add();
    </script>
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    
    

    
    

    
    

    
    
    
    
    
    
    
    
    
    
      
      
    
    
    <script src="/js/wowchemy.min.d4185df71ecf716f1c4e7ef5f3d4e2b8.js"></script>

    






</body>
</html>
