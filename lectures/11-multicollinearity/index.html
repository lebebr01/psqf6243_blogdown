<!DOCTYPE html><html lang="en-us" >

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  
  
  <meta name="generator" content="Wowchemy 5.0.0-beta.1 for Hugo">
  

  

  
  

  
  
  
  
  
    
    
    
  
  

  

  
  
  
    
  
  <meta name="description" content="Multicollinearity">

  
  <link rel="alternate" hreflang="en-us" href="https://psqf6243.brandonlebeau.org/lectures/11-multicollinearity/">

  







  




  
  
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  

  
  
  
  <meta name="theme-color" content="#1565c0">
  

  
  
  
  <script src="/js/mathjax-config.js"></script>
  

  
  
  
  
    
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha256-FMvZuGapsJLjouA6k7Eo2lusoAX9i0ShlWFG6qt7SLc=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous" media="print" onload="this.media='all'">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github.min.css" crossorigin="anonymous" title="hl-light" media="print" onload="this.media='all'">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" media="print" onload="this.media='all'" disabled>
        
      
    

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.css" integrity="sha512-1xoFisiGdy9nvho8EgXuXvnpR5GAMSjFwp40gSRE3NwdUdIMIKuPa7bqoUhLD0O/5tPNhteAsE5XyyMi5reQVA==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.2.2/lazysizes.min.js" integrity="sha512-TmDwFLhg3UA4ZG0Eb4MIyT1O1Mb+Oww5kFG0uHqXsdbyZz9DcvYQhKpGgNkamAI6h2lGGZq2X8ftOJvF/XjTUg==" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js" integrity="" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    

  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.3aad675291f323c3cd47ae187f0bf0d6.css">

  




  

  


  
  

  

  
  <link rel="manifest" href="/index.webmanifest">
  

  <link rel="icon" type="image/png" href="/images/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_32x32_fill_lanczos_center_3.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_192x192_fill_lanczos_center_3.png">

  <link rel="canonical" href="https://psqf6243.brandonlebeau.org/lectures/11-multicollinearity/">

  
  
  
  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="og:site_name" content="PSQF 6243">
  <meta property="og:url" content="https://psqf6243.brandonlebeau.org/lectures/11-multicollinearity/">
  <meta property="og:title" content="Multicollinearity | PSQF 6243">
  <meta property="og:description" content="Multicollinearity"><meta property="og:image" content="https://psqf6243.brandonlebeau.org/media/blue-balloon.jpg">
  <meta property="twitter:image" content="https://psqf6243.brandonlebeau.org/media/blue-balloon.jpg"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2021-10-13T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2021-10-13T00:00:00&#43;00:00">
  

  



  


  


  





  <title>Multicollinearity | PSQF 6243</title>

</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper  ">

  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.7de282f2047be3c570af3a58788341e7.js"></script>

  

<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="Search...">
        
      </div>

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header">
    












<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">PSQF 6243</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">PSQF 6243</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#logistics"><span>Logistics</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/syllabus/"><span>Syllabus</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/schedule/"><span>Schedule</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/content/"><span>Content</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link  active" href="/lectures/"><span>Lecture Notes</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/assignments/"><span>Assignments</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/code/"><span>Software Resources</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#people"><span>People</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

      
      
        
      

      
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#" aria-label="Search"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true" aria-label="Display preferences">
          <i class="fas fa-moon" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>Light</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>Dark</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>Automatic</span>
          </a>
        </div>
      </li>
      

      

    </ul>

  </div>
</nav>


  </div>

  <div class="page-body">
    





<div class="container-fluid docs">
  <div class="row flex-xl-nowrap">
    <div class="col-12 col-md-3 col-xl-2 docs-sidebar">
      <form class="docs-search d-flex align-items-center">
  <button class="btn docs-toggle d-md-none p-0 mr-3" type="button" data-toggle="collapse" data-target="#docs-nav" aria-controls="docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    <span><i class="fas fa-bars"></i></span>
  </button>

  
  <button class="form-control sidebar-search js-search">
    <i class="fas fa-search pr-2"></i>
    <span class="sidebar-search-text">Search...</span>
    <span class="sidebar-search-shortcut">/</span>
  </button>
  
</form>

<nav class="collapse docs-links" id="docs-nav">
  
  
  
  
  
  

  
  
    

    
      

      
      
      


  
    
    
    
    
      
    
    

    
      <ul class="nav docs-sidenav">
        <li class=""><a href="/lectures/">Lecture Notes</a></li>
    
      


  <li class=""><a href="/lectures/review/">Review</a></li>



  <li class=""><a href="/lectures/review-class/">Review - class</a></li>



  <li class=""><a href="/lectures/intro-regression/">Intro to Linear Regression</a></li>



  <li class=""><a href="/lectures/linear-regression-class/">Intro to Linear Regression - class</a></li>



  <li class=""><a href="/lectures/regression-estimates/">Linear Regression Estimates</a></li>



  <li class=""><a href="/lectures/regression-estimates-class/">Linear Regression Estimates - class</a></li>



  <li class=""><a href="/lectures/least-squares-simulation/">Least Square Simulation</a></li>



  <li class=""><a href="/lectures/regression-inference-p1/">Regression Inference - Part 1</a></li>



  <li class=""><a href="/lectures/05-regression-inference/">Regression Inference - Part 1</a></li>



  <li class=""><a href="/lectures/05a-regression-inference/">Regression Inference - Part 2</a></li>



  <li class=""><a href="/lectures/05a-regression-inference-class/">Regression Inference - Part 2 - Class</a></li>



  <li class=""><a href="/lectures/06-t-vs-norm/">t vs Normal</a></li>



  <li class=""><a href="/lectures/07-regression-assumptions/">Regression Assumptions</a></li>



  <li class=""><a href="/lectures/07a-regression-assumptions/">Regression Assumptions - New Package</a></li>



  <li class=""><a href="/lectures/08-bootstrap/">Regression Bootstrap</a></li>



  <li class=""><a href="/lectures/08-bootstrap-class/">Regression Bootstrap - Class</a></li>



  <li class=""><a href="/lectures/09-multiple-regression-p1/">Multiple Regression - Part 1</a></li>



  <li class=""><a href="/lectures/09-multiple-regression-p1-class/">Multiple Regression - Part 1</a></li>



  <li class=""><a href="/lectures/10-model-comparison/">Model Comparison</a></li>



  <li class=""><a href="/lectures/10-model-comparison-class/">Model Comparison</a></li>



  <li class="active"><a href="/lectures/11-multicollinearity/">Multicollinearity</a></li>



  <li class=""><a href="/lectures/11-multicollinearity-class/">Multicollinearity</a></li>



  <li class=""><a href="/lectures/12-regression-categorical/">Regression Categorical Predictors</a></li>



  <li class=""><a href="/lectures/12-regression-categorical-class/">Regression Categorical Predictors</a></li>



  <li class=""><a href="/lectures/13-regression-categorical-p2/">Regression Categorical Predictors - p2</a></li>



  <li class=""><a href="/lectures/13-regression-categorical-p2-class/">Regression Categorical Predictors - p2</a></li>



  <li class=""><a href="/lectures/14-pairwise/">Pairwise Contrasts</a></li>



  <li class=""><a href="/lectures/14-pairwise-class/">Pairwise Contrasts</a></li>



  <li class=""><a href="/lectures/15-multiple-categorical/">Multiple Categorical Predictors</a></li>

      
    

    
      </ul>
    

  
</nav>

    </div>

    
    
    <div class="d-none d-xl-block col-xl-2 docs-toc">
      <ul class="nav toc-top">
        <li><a href="#" id="back_to_top" class="docs-toc-title">Contents</a></li>
      </ul>

      

      
    </div>
    

    <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 docs-content" role="main">

      <article class="article">

        <div class="docs-article-container">
          

          <h1>Multicollinearity</h1>

          <div class="article-style">
            
<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>

<div id="TOC">

</div>

<div id="multicollinearity" class="section level1">
<h1>Multicollinearity</h1>
<p>Multicollinearity is an assumption of regression that explores whether the predictor attributes (X) are correlated. Linear regression assumes that the predictor attributes are uncorrelated, but in practice this assumption is never met. What impacts does multicollinearity have on the linear regression? The short answer is that the regression parameters (the <span class="math inline">\(\beta\)</span> terms) will be more or less unbiased, however, the same cannot be said for the standard errors.</p>
<p>Let’s first use some real data to explore this, then we’ll use simulated data to show the impact correlated predictor attributes have on the linear regression estiamtes.</p>
<pre class="r"><code>library(tidyverse)</code></pre>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──</code></pre>
<pre><code>## ✓ ggplot2 3.3.5     ✓ purrr   0.3.4
## ✓ tibble  3.1.6     ✓ dplyr   1.0.7
## ✓ tidyr   1.1.4     ✓ stringr 1.4.0
## ✓ readr   2.0.2     ✓ forcats 0.5.1</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>library(ggformula)</code></pre>
<pre><code>## Loading required package: ggstance</code></pre>
<pre><code>## 
## Attaching package: &#39;ggstance&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:ggplot2&#39;:
## 
##     geom_errorbarh, GeomErrorbarh</code></pre>
<pre><code>## Loading required package: scales</code></pre>
<pre><code>## 
## Attaching package: &#39;scales&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     discard</code></pre>
<pre><code>## The following object is masked from &#39;package:readr&#39;:
## 
##     col_factor</code></pre>
<pre><code>## Loading required package: ggridges</code></pre>
<pre><code>## 
## New to ggformula?  Try the tutorials: 
##  learnr::run_tutorial(&quot;introduction&quot;, package = &quot;ggformula&quot;)
##  learnr::run_tutorial(&quot;refining&quot;, package = &quot;ggformula&quot;)</code></pre>
<pre class="r"><code>theme_set(theme_bw(base_size = 18))

college &lt;- read_csv(&quot;https://raw.githubusercontent.com/lebebr01/statthink/main/data-raw/College-scorecard-4143.csv&quot;) %&gt;%
  mutate(act_mean = actcmmid - mean(actcmmid, na.rm = TRUE),
         cost_mean = costt4_a - mean(costt4_a, na.rm = TRUE)) %&gt;%
  drop_na(act_mean, cost_mean)</code></pre>
<pre><code>## Rows: 7058 Columns: 16</code></pre>
<pre><code>## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr  (6): instnm, city, stabbr, preddeg, region, locale
## dbl (10): adm_rate, actcmmid, ugds, costt4_a, costt4_p, tuitionfee_in, tuiti...</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<pre class="r"><code>adm_mult_reg &lt;- lm(adm_rate ~ actcmmid + costt4_a, data = college)

summary(adm_mult_reg)</code></pre>
<pre><code>## 
## Call:
## lm(formula = adm_rate ~ actcmmid + costt4_a, data = college)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.65484 -0.12230  0.02291  0.13863  0.37054 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  1.135e+00  3.326e-02  34.130  &lt; 2e-16 ***
## actcmmid    -1.669e-02  1.650e-03 -10.114  &lt; 2e-16 ***
## costt4_a    -2.304e-06  4.047e-07  -5.693 1.55e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1813 on 1278 degrees of freedom
## Multiple R-squared:  0.1836, Adjusted R-squared:  0.1824 
## F-statistic: 143.8 on 2 and 1278 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>library(mosaic)</code></pre>
<pre><code>## Registered S3 method overwritten by &#39;mosaic&#39;:
##   method                           from   
##   fortify.SpatialPolygonsDataFrame ggplot2</code></pre>
<pre><code>## 
## The &#39;mosaic&#39; package masks several functions from core packages in order to add 
## additional features.  The original behavior of these functions should not be affected by this.</code></pre>
<pre><code>## 
## Attaching package: &#39;mosaic&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:Matrix&#39;:
## 
##     mean</code></pre>
<pre><code>## The following object is masked from &#39;package:scales&#39;:
## 
##     rescale</code></pre>
<pre><code>## The following objects are masked from &#39;package:dplyr&#39;:
## 
##     count, do, tally</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     cross</code></pre>
<pre><code>## The following object is masked from &#39;package:ggplot2&#39;:
## 
##     stat</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     binom.test, cor, cor.test, cov, fivenum, IQR, median, prop.test,
##     quantile, sd, t.test, var</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     max, mean, min, prod, range, sample, sum</code></pre>
<pre class="r"><code>cor(actcmmid ~ costt4_a, data = college)</code></pre>
<pre><code>## [1] 0.5557307</code></pre>
<div id="variance-inflation-factor" class="section level2">
<h2>Variance Inflation Factor</h2>
<p>The variance inflation factor (VIF) is a commonly used statistic to aid in diagnosing multicollinearity. It attempts to estimate how much the variance of the estimated regression equation is inflated due to correlated predictor attributes.</p>
<p>First, this can be calculated from the car package, using the function <code>vif()</code>.</p>
<pre class="r"><code>library(car)</code></pre>
<pre><code>## Loading required package: carData</code></pre>
<pre><code>## 
## Attaching package: &#39;car&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:mosaic&#39;:
## 
##     deltaMethod, logit</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     recode</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     some</code></pre>
<pre class="r"><code>vif(adm_mult_reg)</code></pre>
<pre><code>## actcmmid costt4_a 
## 1.446836 1.446836</code></pre>
<p>Fundamentally, the VIF is calculated with the following steps.</p>
<ol style="list-style-type: decimal">
<li>Fit a regression where one of the X attributes is the outcome and the remaining X attributes are predictors.</li>
<li>Calculate VIF: <span class="math inline">\(VIF = 1 / 1 - R^2\)</span> from step 1.</li>
<li>Repeate this for all X attributes.</li>
<li>Evaluate extent to which VIF is problematic. Rules of thumb include VIF statistics greater than 5 or 10.</li>
</ol>
<p>Interpretation wise, the square root of the VIF statistic can provide an indication of how inflated the standard error would be if the predictors are uncorrelated.</p>
<pre class="r"><code>act_lm &lt;- lm(actcmmid ~ costt4_a, data = college)
summary(act_lm)$r.square</code></pre>
<pre><code>## [1] 0.3088366</code></pre>
<pre class="r"><code>1 / (1 - .3088)</code></pre>
<pre><code>## [1] 1.446759</code></pre>
<pre class="r"><code>sqrt(1.446)</code></pre>
<pre><code>## [1] 1.202497</code></pre>
<div id="simulated-data-exploration" class="section level3">
<h3>Simulated data exploration</h3>
<p>Let’s use some simulated data to show the extent to which multicollinearity can be problematic, particularly for more highly correlated attributes.</p>
<p>First, let’s start with uncorrelated (on average) predictor attributes.</p>
<pre class="r"><code>library(simglm)

sim_args &lt;- list(formula = y ~ 1 + act + gpa + sat, 
                 fixed = list(act = list(var_type = &#39;continuous&#39;,
                                         mean = 20, 
                                         sd = 4),
                              gpa = list(var_type = &#39;continuous&#39;,
                                         mean = 2, 
                                         sd = .5),
                              sat = list(var_type = &#39;continuous&#39;,
                                         mean = 500, 
                                         sd = 100)),
                 correlate = list(fixed = data.frame(x = c(&#39;act&#39;, &#39;act&#39;, &#39;gpa&#39;), 
                                                     y = c(&#39;gpa&#39;, &#39;sat&#39;, &#39;sat&#39;), 
                                                     corr = c(0, 0, 0))),
                error = list(variance = 100),
                reg_weights = c(1, 1, 1, 1),
                 sample_size = 10000)

sim_data &lt;- simulate_fixed(data = NULL, sim_args) %&gt;%
   simulate_error(sim_args) %&gt;%
   correlate_variables(sim_args) %&gt;%
   generate_response(sim_args)

head(sim_data)</code></pre>
<pre><code>##   X.Intercept.  act_old  gpa_old  sat_old level1_id     error      act      gpa
## 1            1 17.08102 2.482120 341.1258         1  1.791652 23.85696 1.205629
## 2            1 21.05572 1.555534 543.8622         2  2.874917 16.44427 2.219311
## 3            1 18.49288 1.674077 470.5520         3 -9.748876 17.39262 1.852760
## 4            1 10.51129 2.751521 537.0149         4 13.014819 26.01217 2.185074
## 5            1 22.27143 2.559141 598.6254         5 -1.646120 24.47313 2.493127
## 6            1 16.83541 2.051506 590.4130         6  2.667773 20.41205 2.452065
##        sat fixed_outcome random_effects        y
## 1 427.0255      453.0880              0 454.8797
## 2 526.3930      546.0565              0 548.9315
## 3 462.3220      482.5674              0 472.8185
## 4 262.7822      291.9795              0 304.9943
## 5 556.7859      584.7521              0 583.1060
## 6 420.8852      444.7493              0 447.4171</code></pre>
<pre class="r"><code>cor(sim_data[c(&#39;y&#39;, &#39;act&#39;, &#39;gpa&#39;, &#39;sat&#39;)])</code></pre>
<pre><code>##              y           act          gpa          sat
## y   1.00000000  0.0344732665 0.0165364500  0.994182302
## act 0.03447327  1.0000000000 0.0006571286 -0.006058021
## gpa 0.01653645  0.0006571286 1.0000000000  0.011645761
## sat 0.99418230 -0.0060580207 0.0116457612  1.000000000</code></pre>
<pre class="r"><code>sim_lm &lt;- lm(y ~ 1 + act + gpa + sat, data = sim_data)
summary(sim_lm)</code></pre>
<pre><code>## 
## Call:
## lm(formula = y ~ 1 + act + gpa + sat, data = sim_data)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -43.494  -6.769   0.026   6.824  43.185 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 1.224098   0.818820   1.495    0.135    
## act         1.008839   0.024840  40.613  &lt; 2e-16 ***
## gpa         0.996111   0.201485   4.944 7.78e-07 ***
## sat         0.999083   0.001002 997.219  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 10.02 on 9996 degrees of freedom
## Multiple R-squared:  0.9901, Adjusted R-squared:  0.9901 
## F-statistic: 3.32e+05 on 3 and 9996 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>vif(sim_lm)</code></pre>
<pre><code>##      act      gpa      sat 
## 1.000037 1.000136 1.000172</code></pre>
<p>Let’s now increase the correlation among the attributes.</p>
<pre class="r"><code>library(simglm)

sim_args &lt;- list(formula = y ~ 1 + act + gpa + sat, 
                 fixed = list(act = list(var_type = &#39;continuous&#39;,
                                         mean = 20, 
                                         sd = 4),
                              gpa = list(var_type = &#39;continuous&#39;,
                                         mean = 2, 
                                         sd = .5),
                              sat = list(var_type = &#39;continuous&#39;,
                                         mean = 500, 
                                         sd = 100)),
                 correlate = list(fixed = data.frame(x = c(&#39;act&#39;, &#39;act&#39;, &#39;gpa&#39;), 
                                                     y = c(&#39;gpa&#39;, &#39;sat&#39;, &#39;sat&#39;), 
                                                     corr = c(0.5, 0.5, 0.25))),
                error = list(variance = 100),
                reg_weights = c(1, 1, 1, 1),
                 sample_size = 10000)

sim_data &lt;- simulate_fixed(data = NULL, sim_args) %&gt;%
   simulate_error(sim_args) %&gt;%
   correlate_variables(sim_args) %&gt;%
   generate_response(sim_args)

head(sim_data)</code></pre>
<pre><code>##   X.Intercept.  act_old  gpa_old  sat_old level1_id      error      act
## 1            1 21.31759 1.472351 493.3060         1 -12.896777 15.68450
## 2            1 16.12588 1.925363 573.7497         2  15.953945 21.44271
## 3            1 22.37918 2.198192 589.5717         3 -16.419317 20.20602
## 4            1 17.13984 1.312183 269.2184         4  -8.216797 16.60534
## 5            1 18.26712 1.060117 488.4274         5   3.076921 14.35543
## 6            1 12.32549 1.873625 486.3947         6  12.912382 22.96298
##        gpa      sat fixed_outcome random_effects        y
## 1 1.755654 467.1337      485.5738              0 472.6770
## 2 1.770326 596.8633      621.0764              0 637.0303
## 3 1.626387 440.4929      463.3253              0 446.9060
## 4 2.782410 571.5997      591.9875              0 583.7707
## 5 1.690891 543.4528      560.4991              0 563.5761
## 6 2.243236 691.8802      718.0864              0 730.9988</code></pre>
<pre class="r"><code>cor(sim_data[c(&#39;y&#39;, &#39;act&#39;, &#39;gpa&#39;, &#39;sat&#39;)])</code></pre>
<pre><code>##             y       act       gpa       sat
## y   1.0000000 0.5273231 0.2610306 0.9946605
## act 0.5273231 1.0000000 0.4825130 0.4984210
## gpa 0.2610306 0.4825130 1.0000000 0.2423112
## sat 0.9946605 0.4984210 0.2423112 1.0000000</code></pre>
<pre class="r"><code>sim_lm2 &lt;- lm(y ~ 1 + act + gpa + sat, data = sim_data)
vif(sim_lm2)</code></pre>
<pre><code>##      act      gpa      sat 
## 1.632498 1.303480 1.330544</code></pre>
<pre class="r"><code>broom::tidy(sim_lm)</code></pre>
<pre><code>## # A tibble: 4 × 5
##   term        estimate std.error statistic     p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;
## 1 (Intercept)    1.22    0.819        1.49 0.135      
## 2 act            1.01    0.0248      40.6  0          
## 3 gpa            0.996   0.201        4.94 0.000000778
## 4 sat            0.999   0.00100    997.   0</code></pre>
<pre class="r"><code>broom::tidy(sim_lm2)</code></pre>
<pre><code>## # A tibble: 4 × 5
##   term        estimate std.error statistic   p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1 (Intercept)    0.698   0.606        1.15 2.50e-  1
## 2 act            0.992   0.0314      31.6  2.27e-209
## 3 gpa            1.29    0.227        5.71 1.17e-  8
## 4 sat            1.00    0.00114    875.   0</code></pre>
<pre class="r"><code>library(simglm)

sim_args &lt;- list(formula = y ~ 1 + act + gpa + sat, 
                 fixed = list(act = list(var_type = &#39;continuous&#39;,
                                         mean = 20, 
                                         sd = 4),
                              gpa = list(var_type = &#39;continuous&#39;,
                                         mean = 2, 
                                         sd = .5),
                              sat = list(var_type = &#39;continuous&#39;,
                                         mean = 500, 
                                         sd = 100)),
                 correlate = list(fixed = data.frame(x = c(&#39;act&#39;, &#39;act&#39;, &#39;gpa&#39;), 
                                                     y = c(&#39;gpa&#39;, &#39;sat&#39;, &#39;sat&#39;), 
                                                     corr = c(0.5, 0.9, 0.5))),
                error = list(variance = 100),
                reg_weights = c(1, 1, 1, 1),
                 sample_size = 10000)

sim_data &lt;- simulate_fixed(data = NULL, sim_args) %&gt;%
   simulate_error(sim_args) %&gt;%
   correlate_variables(sim_args) %&gt;%
   generate_response(sim_args)

head(sim_data)</code></pre>
<pre><code>##   X.Intercept.  act_old  gpa_old  sat_old level1_id     error      act      gpa
## 1            1 18.51301 2.951166 499.3138         1 -3.033404 24.65100 2.211716
## 2            1 15.16173 2.479075 669.2361         2 -2.688822 26.04953 1.635284
## 3            1 22.71691 2.293074 531.3927         3  3.434085 18.57937 1.731277
## 4            1 15.31205 2.151823 636.9452         4  7.806310 24.76972 1.724465
## 5            1 18.12330 1.906751 287.1408         5 -2.244450 21.33286 3.018458
## 6            1 15.11732 1.919959 629.7995         6 -3.516431 24.13649 1.739037
##        sat fixed_outcome random_effects        y
## 1 537.0552      564.9179              0 561.8845
## 2 620.8974      649.5822              0 646.8934
## 3 432.0407      453.3513              0 456.7854
## 4 617.1805      644.6747              0 652.4810
## 5 546.9281      572.2794              0 570.0350
## 6 622.0778      648.9534              0 645.4369</code></pre>
<pre class="r"><code>cor(sim_data[c(&#39;y&#39;, &#39;act&#39;, &#39;gpa&#39;, &#39;sat&#39;)])</code></pre>
<pre><code>##             y       act       gpa       sat
## y   1.0000000 0.9014804 0.5077501 0.9953143
## act 0.9014804 1.0000000 0.5040444 0.8986520
## gpa 0.5077501 0.5040444 1.0000000 0.5055510
## sat 0.9953143 0.8986520 0.5055510 1.0000000</code></pre>
<pre class="r"><code>sim_lm3 &lt;- lm(y ~ 1 + act + gpa + sat, data = sim_data)
vif(sim_lm3)</code></pre>
<pre><code>##      act      gpa      sat 
## 5.288140 1.366931 5.298946</code></pre>
<pre class="r"><code>broom::tidy(sim_lm)</code></pre>
<pre><code>## # A tibble: 4 × 5
##   term        estimate std.error statistic     p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;
## 1 (Intercept)    1.22    0.819        1.49 0.135      
## 2 act            1.01    0.0248      40.6  0          
## 3 gpa            0.996   0.201        4.94 0.000000778
## 4 sat            0.999   0.00100    997.   0</code></pre>
<pre class="r"><code>broom::tidy(sim_lm2)</code></pre>
<pre><code>## # A tibble: 4 × 5
##   term        estimate std.error statistic   p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1 (Intercept)    0.698   0.606        1.15 2.50e-  1
## 2 act            0.992   0.0314      31.6  2.27e-209
## 3 gpa            1.29    0.227        5.71 1.17e-  8
## 4 sat            1.00    0.00114    875.   0</code></pre>
<pre class="r"><code>broom::tidy(sim_lm3)</code></pre>
<pre><code>## # A tibble: 4 × 5
##   term        estimate std.error statistic  p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 (Intercept)    2.40    0.539        4.45 8.50e- 6
## 2 act            0.925   0.0569      16.2  1.33e-58
## 3 gpa            0.785   0.233        3.37 7.50e- 4
## 4 sat            1.00    0.00228    438.   0</code></pre>
<pre class="r"><code>library(simglm)

sim_args &lt;- list(formula = y ~ 1 + act + gpa + sat, 
                 fixed = list(act = list(var_type = &#39;continuous&#39;,
                                         mean = 20, 
                                         sd = 4),
                              gpa = list(var_type = &#39;continuous&#39;,
                                         mean = 2, 
                                         sd = .5),
                              sat = list(var_type = &#39;continuous&#39;,
                                         mean = 500, 
                                         sd = 100)),
                 correlate = list(fixed = data.frame(x = c(&#39;act&#39;, &#39;act&#39;, &#39;gpa&#39;), 
                                                     y = c(&#39;gpa&#39;, &#39;sat&#39;, &#39;sat&#39;), 
                                                     corr = c(0.9, 0.98, 0.85))),
                error = list(variance = 100),
                reg_weights = c(1, 1, 1, 1),
                 sample_size = 10000)

sim_data &lt;- simulate_fixed(data = NULL, sim_args) %&gt;%
   simulate_error(sim_args) %&gt;%
   correlate_variables(sim_args) %&gt;%
   generate_response(sim_args)

head(sim_data)</code></pre>
<pre><code>##   X.Intercept.  act_old  gpa_old  sat_old level1_id      error      act
## 1            1 26.28361 2.149387 367.3294         1   8.020991 14.02101
## 2            1 21.03343 1.970490 698.7051         2   1.101973 19.02682
## 3            1 17.27154 1.701159 488.7892         3  -5.816922 22.19489
## 4            1 16.71857 1.778231 623.7122         4   6.796698 22.91789
## 5            1 23.96722 2.083713 587.1804         5  -6.750945 16.28267
## 6            1 23.32387 2.452745 355.7584         6 -13.106936 17.39817
##        gpa      sat fixed_outcome random_effects        y
## 1 1.641906 342.9013      359.5642              0 367.5852
## 2 1.495996 474.1643      495.6871              0 496.7891
## 3 2.204570 568.2305      593.6300              0 587.8131
## 4 2.030447 582.0489      607.9972              0 614.7939
## 5 1.440093 400.8133      419.5361              0 412.7851
## 6 2.087386 416.8757      437.3613              0 424.2543</code></pre>
<pre class="r"><code>cor(sim_data[c(&#39;y&#39;, &#39;act&#39;, &#39;gpa&#39;, &#39;sat&#39;)])</code></pre>
<pre><code>##             y       act       gpa       sat
## y   1.0000000 0.9772147 0.8488827 0.9953878
## act 0.9772147 1.0000000 0.8999740 0.9800346
## gpa 0.8488827 0.8999740 1.0000000 0.8495786
## sat 0.9953878 0.9800346 0.8495786 1.0000000</code></pre>
<pre class="r"><code>sim_lm4 &lt;- lm(y ~ 1 + act + gpa + sat, data = sim_data)
vif(sim_lm4)</code></pre>
<pre><code>##       act       gpa       sat 
## 43.057924  6.118162 29.412449</code></pre>
<pre class="r"><code>broom::tidy(sim_lm)</code></pre>
<pre><code>## # A tibble: 4 × 5
##   term        estimate std.error statistic     p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;
## 1 (Intercept)    1.22    0.819        1.49 0.135      
## 2 act            1.01    0.0248      40.6  0          
## 3 gpa            0.996   0.201        4.94 0.000000778
## 4 sat            0.999   0.00100    997.   0</code></pre>
<pre class="r"><code>broom::tidy(sim_lm2)</code></pre>
<pre><code>## # A tibble: 4 × 5
##   term        estimate std.error statistic   p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1 (Intercept)    0.698   0.606        1.15 2.50e-  1
## 2 act            0.992   0.0314      31.6  2.27e-209
## 3 gpa            1.29    0.227        5.71 1.17e-  8
## 4 sat            1.00    0.00114    875.   0</code></pre>
<pre class="r"><code>broom::tidy(sim_lm3)</code></pre>
<pre><code>## # A tibble: 4 × 5
##   term        estimate std.error statistic  p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 (Intercept)    2.40    0.539        4.45 8.50e- 6
## 2 act            0.925   0.0569      16.2  1.33e-58
## 3 gpa            0.785   0.233        3.37 7.50e- 4
## 4 sat            1.00    0.00228    438.   0</code></pre>
<pre class="r"><code>broom::tidy(sim_lm4)</code></pre>
<pre><code>## # A tibble: 4 × 5
##   term        estimate std.error statistic  p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 (Intercept)    0.451   0.526       0.856 3.92e- 1
## 2 act            1.04    0.165       6.32  2.79e-10
## 3 gpa            0.417   0.495       0.843 3.99e- 1
## 4 sat            1.00    0.00544   184.    0</code></pre>
</div>
</div>
</div>

          </div>

          



          
          
          <div class="article-widget">
            
<div class="post-nav">
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Previous</div>
    <a href="/lectures/10-model-comparison-class/" rel="next">Model Comparison</a>
  </div>
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Next</div>
    <a href="/lectures/11-multicollinearity-class/" rel="prev">Multicollinearity</a>
  </div>
  
</div>

          </div>
          
        </div>

        <div class="body-footer">
          <p>Last updated on Oct 13, 2021</p>

          



          




          


        </div>

      </article>

      <footer class="site-footer">
  

  <p class="powered-by">
    
  </p>

  
  






  <p class="powered-by">
    
    
    
    Published with
    <a href="https://wowchemy.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Wowchemy</a>  —
    the free, <a href="https://github.com/wowchemy/wowchemy-hugo-modules" target="_blank" rel="noopener">
    open source</a> website builder that empowers creators.
    
  </p>
</footer>


    </main>
  </div>
</div>

  </div>

  <div class="page-footer">
    
    
  </div>

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

      
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      

      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/instant.page/5.1.0/instantpage.min.js" integrity="sha512-1+qUtKoh9XZW7j+6LhRMAyOrgSQKenQ4mluTR+cvxXjP1Z54RxZuzstR/H9kgPXQsVB8IW7DMDFUJpzLjvhGSQ==" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js" integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/r.min.js"></script>
        
      

    

    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.js" integrity="sha512-SeiQaaDh73yrb56sTW/RgVdi/mMqNeM2oBwubFHagc5BkixSpP1fvqF47mKzPGWYSSy4RwbBunrJBQ4Co8fRWA==" crossorigin="anonymous"></script>
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'event' : "Events",
        'slides' : "Slides"
        };
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.2/anchor.min.js" integrity="sha512-I7w3ZdSFzw5j3jU3ZkNikBNeIrl3i+hEuEdwNmqUJvwNcaBUNcijnP2gd9DtGlgVYDplfjGoD8vTNsID+lCjqg==" crossorigin="anonymous"></script>
    <script>
      anchors.add();
    </script>
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    
    

    
    

    
    

    
    
    
    
    
    
    
    
    
    
      
      
    
    
    <script src="/js/wowchemy.min.d4185df71ecf716f1c4e7ef5f3d4e2b8.js"></script>

    






</body>
</html>
